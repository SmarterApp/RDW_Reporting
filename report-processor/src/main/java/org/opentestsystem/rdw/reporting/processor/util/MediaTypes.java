package org.opentestsystem.rdw.reporting.processor.util;

import com.google.common.collect.ImmutableMap;
import org.springframework.http.MediaType;

import java.util.Map;
import java.util.Optional;

/**
 * Utility class for handling custom MediaTypes.
 */
public class MediaTypes {

    public static final MediaType APPLICATION_PDF_UTF8 = new MediaType(
            MediaType.APPLICATION_PDF,
            ImmutableMap.of("charset", "UTF-8"));

    public static final MediaType APPLICATION_ZIP = new MediaType("application", "zip");

    public static final Map<String, MediaType> ExtensionToMediaType = ImmutableMap.<String, MediaType>builder()
            .put("pdf", APPLICATION_PDF_UTF8)
            .put("zip", APPLICATION_ZIP)
            .build();

    public static String getExtension(final MediaType mediaType) {
        final Optional<Map.Entry<String, MediaType>> extension = ExtensionToMediaType.entrySet().stream()
                .filter(entry -> entry.getValue().isCompatibleWith(mediaType))
                .findFirst();
        if (!extension.isPresent()) {
            throw new IllegalArgumentException("Unknown media type: " + mediaType);
        }
        return extension.get().getKey();
    }
}
