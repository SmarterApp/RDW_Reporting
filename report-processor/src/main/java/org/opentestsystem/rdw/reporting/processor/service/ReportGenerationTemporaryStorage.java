package org.opentestsystem.rdw.reporting.processor.service;

import java.io.InputStream;
import java.util.List;
import java.util.function.Supplier;

/**
 * Implementations of this interface are responsible for providing
 * shared, cross-server temporary storage of report chunk content.
 */
public interface ReportGenerationTemporaryStorage {

    /**
     * Write the given chunk content into temporary storage.
     *
     * @param reportId      The report id
     * @param chunkIdx      The chunk index
     * @param content       The chunk content
     */
    void writeChunk(long reportId, int chunkIdx, InputStream content);

    /**
     * Retrieve the stored chunk contents in chunk order.
     *
     * @param reportId      The report id
     * @param chunkCount    The total number of chunks
     * @return The ordered chunk contents.
     */
    List<Supplier<InputStream>> getChunks(long reportId, int chunkCount);

    /**
     * Remove any persistent storage.
     *
     * @param reportId  The report id
     */
    void cleanup(long reportId);
}
