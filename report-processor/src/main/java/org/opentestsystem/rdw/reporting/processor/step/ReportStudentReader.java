package org.opentestsystem.rdw.reporting.processor.step;

import org.opentestsystem.rdw.reporting.processor.model.StudentChunk;
import org.springframework.batch.item.ItemReader;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import java.util.concurrent.BlockingQueue;

/**
 * This item reader provides the students already present in the
 * Job-scoped students queue.
 */
@Component
public class ReportStudentReader implements ItemReader<StudentChunk> {

    private final BlockingQueue<StudentChunk> studentChunks;

    @Autowired
    public ReportStudentReader(final BlockingQueue<StudentChunk> studentChunks) {
        this.studentChunks = studentChunks;
    }

    @Override
    public StudentChunk read() throws Exception {
        return studentChunks.poll();
    }
}
