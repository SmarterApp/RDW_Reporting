package org.opentestsystem.rdw.reporting.processor.configuration;

import org.springframework.boot.context.properties.ConfigurationProperties;

import static com.google.common.base.Preconditions.checkArgument;

/**
 * Configuration properties for generating a student PDF report.
 */
@ConfigurationProperties(prefix = "report")
public class ReportGenerationProperties {
    private int chunkSize = 25;
    private int pdfPageCutoff = 1000;

    /**
     * NOTE: This value should take into account the memory limits of the available
     * wkhtmltopdf services.
     *
     * @return The number of student reports to process at once
     */
    public int getChunkSize() {
        return chunkSize;
    }

    public void setChunkSize(final int chunkSize) {
        checkArgument(chunkSize > 0, "ChunkSize must be greater than 0");
        this.chunkSize = chunkSize;
    }

    /**
     * This property is used to control how large a single PDF file should be.  After
     * merging a {@link #chunkSize} number student reports into the merged report PDF,
     * if the page count is larger than this cutoff a new PDF file will be created to
     * hold additional PDF report pages.  If a report contains more than one PDF,
     * it will be persisted and served to the user as a multiple-PDF .zip resource.
     *
     * @return The number of pages at which to create a new PDF report file
     */
    public int getPdfPageCutoff() {
        return pdfPageCutoff;
    }

    public void setPdfPageCutoff(final int pdfPageCutoff) {
        checkArgument(pdfPageCutoff > 0, "PdfPageCutoff must be greater than 0");
        this.pdfPageCutoff = pdfPageCutoff;
    }
}
