package org.opentestsystem.rdw.reporting.processor.configuration;

import org.opentestsystem.rdw.archive.ArchiveService;
import org.opentestsystem.rdw.reporting.common.repository.ReportTemplateRepository;
import org.opentestsystem.rdw.reporting.common.repository.impl.ArchiveBackedReportTemplateRepository;
import org.opentestsystem.rdw.reporting.processor.thymeleaf.ReportTemplateResolver;
import org.opentestsystem.rdw.reporting.processor.thymeleaf.ReportingDialect;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.io.ResourceLoader;

/**
 * Additional configurations for the Thymeleaf template processor.
 */
@Configuration
public class ThymeleafConfiguration {

    @Bean
    public ReportingDialect reportingDialect() {
        return new ReportingDialect();
    }

    @Bean
    public ReportTemplateResolver reportTemplateResolver(final ReportTemplateRepository templateRepository,
                                                         final ResourceLoader resourceLoader) {
        return new ReportTemplateResolver(templateRepository, resourceLoader);
    }

    @Bean
    public ArchiveBackedReportTemplateRepository reportTemplateRepository(final ArchiveService archiveService) {
        return new ArchiveBackedReportTemplateRepository(archiveService);
    }
}
