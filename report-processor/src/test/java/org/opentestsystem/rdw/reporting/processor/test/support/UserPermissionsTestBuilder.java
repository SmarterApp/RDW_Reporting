package org.opentestsystem.rdw.reporting.processor.test.support;

import com.google.common.collect.ImmutableMap;
import org.opentestsystem.rdw.reporting.processor.model.UserPermissions;
import org.opentestsystem.rdw.security.Permission;
import org.opentestsystem.rdw.security.PermissionScope;

import static org.opentestsystem.rdw.reporting.common.security.ReportingPermission.GroupPiiRead;
import static org.opentestsystem.rdw.reporting.common.security.ReportingPermission.IndividualPiiRead;

/**
 * Test utility for creating UserPermissions instances.
 */
public class UserPermissionsTestBuilder {

    public static UserPermissions individual(final PermissionScope permissionScope) {
        return UserPermissions.builder()
                .permissionsById(ImmutableMap.of(
                        IndividualPiiRead, new Permission(IndividualPiiRead, permissionScope)))
                .build();
    }

    public static UserPermissions group(final PermissionScope permissionScope) {
        return UserPermissions.builder()
                .permissionsById(ImmutableMap.of(
                        GroupPiiRead, new Permission(GroupPiiRead, permissionScope)))
                .build();
    }
}
