package org.opentestsystem.rdw.reporting.processor.test.support;

import com.google.common.collect.ImmutableMap;
import org.opentestsystem.rdw.reporting.common.web.security.User;
import org.opentestsystem.rdw.security.Permission;
import org.opentestsystem.rdw.security.PermissionScope;

import static org.opentestsystem.rdw.reporting.common.security.ReportingPermission.GroupPiiRead;
import static org.opentestsystem.rdw.reporting.common.security.ReportingPermission.IndividualPiiRead;

/**
 * Test utility for creating UserPermissions instances.
 */
public class UserTestBuilder {

    public static User individual(final PermissionScope permissionScope) {
        return User.builder()
                .id("userId")
                .username("someone@somewhere.com")
                .password("redacted")
                .permissionsById(ImmutableMap.of(
                        IndividualPiiRead, new Permission(IndividualPiiRead, permissionScope)))
                .build();
    }

    public static User group(final PermissionScope permissionScope) {
        return User.builder()
                .id("userId")
                .username("someone@somewhere.com")
                .password("redacted")
                .permissionsById(ImmutableMap.of(
                        GroupPiiRead, new Permission(GroupPiiRead, permissionScope)))
                .build();
    }

    public static User user() {
        return User.builder()
                .id("userId")
                .username("someone@somewhere.com")
                .password("redacted")
                .build();
    }
}
