package org.opentestsystem.rdw.reporting.common.codedentity;

import org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate;

import java.util.List;

public abstract class AbstractJdbcCodedEntityRepository implements CodedEntityRepository {

    private final NamedParameterJdbcTemplate template;

    AbstractJdbcCodedEntityRepository(final NamedParameterJdbcTemplate template) {
        this.template = template;
    }

    public List<CodedEntity> findAll() {
        return template.query(
                getFindAllQuery(),
                (row, index) -> CodedEntity.builder()
                        .id(row.getInt("id"))
                        .code(row.getString("code"))
                        .build()
        );
    }

    abstract protected String getFindAllQuery();

}
