package org.opentestsystem.rdw.reporting.common.jdbc;

import org.opentestsystem.rdw.reporting.common.model.Target;

import java.sql.ResultSet;
import java.sql.SQLException;

import static org.opentestsystem.rdw.reporting.common.jdbc.QueryUtils.hasColumn;

/**
 * Holds utility methods for mapping SQL query results to {@link Target}
 */
public final class Targets {

    public static Target map(final ResultSet row) throws SQLException {
        final Target.Builder builder = Target.builder()
                .id(row.getInt("id"))
                .assessmentId(row.getInt("asmt_id"))
                .naturalId(row.getString("natural_id"))
                .claimCode(row.getString("claim_code"))
                .includeInReport(row.getBoolean("include_in_report"));

        if (hasColumn(row, "code")) {
            builder.code(row.getString("code"));
        }
        if (hasColumn(row, "description")) {
            builder.description(row.getString("description"));
        }
        return builder.build();
    }
}