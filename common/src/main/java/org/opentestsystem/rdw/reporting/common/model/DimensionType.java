package org.opentestsystem.rdw.reporting.common.model;

import java.util.Arrays;
import java.util.List;

import static java.util.Comparator.comparingInt;
import static java.util.stream.Collectors.toList;

/**
 * Represents available drill down dimensions.
 * Note: The codes are associated with SBAC data terms defined by Organization Exam Export
 * functionality.
 */
public enum DimensionType {
    Custom(-2, "Custom"),
    Overall(-1, "Overall"),
    Gender(1, "Sex"),
    Ethnicity(2, "Ethnicity"),
    LEP(3, "LEPStatus"),
    ELAS(3, "EnglishLanguageAcquisitionStatus"),
    Section504(4, "Section504Status"),
    IEP(5, "IDEAIndicator"),
    MigrantStatus(6, "MigrantStatus"),
    EconomicDisadvantage(7, "EconomicDisadvantageStatus"),
    StudentEnrolledGrade(8, "GradeLevelWhenAssessed");

    private int displayOrder;
    private String code;

    DimensionType(final int displayOrder, final String code) {
        this.displayOrder = displayOrder;
        this.code = code;
    }

    public int displayOrder() {
        return displayOrder;
    }

    public String code() {
        return code;
    }

    public static DimensionType caseInsensitiveValue(final String name) {
        for (final DimensionType type : DimensionType.values()) {
            if (type.name().equalsIgnoreCase(name)) {
                return type;
            }
        }
        return null;
    }

    public static List<DimensionType> orderedDisplayValues() {
        return Arrays.stream(values())
                .filter(type -> (type.displayOrder > 0))
                .sorted(comparingInt(DimensionType::displayOrder))
                .collect(toList());
    }
}
