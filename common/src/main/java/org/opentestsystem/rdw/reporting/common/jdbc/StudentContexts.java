package org.opentestsystem.rdw.reporting.common.jdbc;

import org.opentestsystem.rdw.reporting.common.model.StudentContext;

import java.sql.ResultSet;
import java.sql.SQLException;

import static org.opentestsystem.rdw.reporting.common.jdbc.QueryUtils.getNullable;

public class StudentContexts {
    private StudentContexts() {
    }

    public static <T extends StudentContext.Builder> T map(final ResultSet row, final T builder) throws SQLException {
        builder.iep(getNullable(row, row.getBoolean("iep")))
               .lep(getNullable(row, row.getBoolean("lep")))
               .section504(getNullable(row, row.getBoolean("section504")))
               .elasCode(row.getString("elas_code"))
               .languageCode(row.getString("language_code"))
               .militaryConnectedCode(row.getString("military_connected_code"))
               .migrantStatus(getNullable(row, row.getBoolean("migrant_status")));
        return builder;
    }
}
