package org.opentestsystem.rdw.reporting.common.jdbc;

import org.opentestsystem.rdw.reporting.common.model.AssessmentItem;

import java.sql.ResultSet;
import java.sql.SQLException;

import static org.opentestsystem.rdw.reporting.common.jdbc.QueryUtils.getNullable;
import static org.opentestsystem.rdw.reporting.common.jdbc.QueryUtils.safeSplit;

/**
 * Holds utility methods for mapping SQL query results to {@link AssessmentItem}s.
 */
public class AssessmentItems {

    public static AssessmentItem map(final ResultSet row) throws SQLException {
        return AssessmentItem.builder()
                .id(row.getLong("id"))
                .position(row.getInt("position"))
                .bankItemKey(row.getString("natural_id"))
                .difficultyCode(row.getString("difficulty_code"))
                .maximumPoints(row.getInt("max_points"))
                .claimCode(row.getString("claim_code"))
                .targetCode(row.getString("target_code"))
                .targetId(row.getInt("target_id"))
                .depthOfKnowledgeCode(row.getString("dok_level_subject_id"))
                .mathPracticeCode(row.getString("math_practice_code"))
                .allowCalculator(getNullable(row, row.getBoolean("allow_calc")))
                .commonCoreStandardIds(safeSplit(row.getString("common_core_standard_ids"), "|"))
                .answerKey(row.getString("answer_key"))
                .optionsCount(row.getInt("options_count"))
                .type(row.getString("type"))
                .performanceTaskWritingType(row.getString("performance_task_writing_type"))
                .build();
    }

}
