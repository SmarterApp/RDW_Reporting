package org.opentestsystem.rdw.reporting.common.jdbc;

import org.opentestsystem.rdw.reporting.common.model.ScaleScore;

import java.sql.ResultSet;
import java.sql.SQLException;

import static org.opentestsystem.rdw.reporting.common.jdbc.QueryUtils.getNullable;

/**
 * Holds utility methods for mapping SQL query results to {@link ScaleScore}
 */
public final class ScaleScores {

    private ScaleScores() {
    }

    public static ScaleScore map(final ResultSet row) throws SQLException {
        return map(row, "");
    }

    public static ScaleScore map(final ResultSet row, final String prefix) throws SQLException {
        final Integer scaleScoreLevel = getNullable(row, row.getInt(prefix + "performance_level"));
        return scaleScoreLevel == null ? null : ScaleScore.builder()
                .level(scaleScoreLevel)
                .value(row.getInt(prefix + "scale_score"))
                .standardError(row.getDouble(prefix + "scale_score_std_err"))
                .build();
    }

}
