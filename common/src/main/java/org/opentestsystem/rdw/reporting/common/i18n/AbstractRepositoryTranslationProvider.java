package org.opentestsystem.rdw.reporting.common.i18n;

import java.util.List;
import java.util.Locale;
import java.util.Properties;

import static com.google.common.base.Preconditions.checkNotNull;

/**
 * This TranslationProvider provides translation messages from the TranslationRepository.
 */
public abstract class AbstractRepositoryTranslationProvider extends AbstractPropertiesTranslationProvider {

    private final TranslationRepository translationRepository;
    private final TranslationNamespace namespace;

    public AbstractRepositoryTranslationProvider(final TranslationNamespace namespace,
                                                 final TranslationRepository translationRepository) {
        this.namespace = namespace;
        this.translationRepository = translationRepository;
    }

    @Override
    protected Properties getMessageProperties(final Locale locale) {
        final List<Translation> translations = translationRepository.findAllForLanguageAndNamespace(checkNotNull(locale).getISO3Language(), namespace);
        final Properties messages = new Properties();
        translations.forEach(translation -> {
            messages.put(translation.getCode(), translation.getValue());
        });
        return messages;
    }

}
