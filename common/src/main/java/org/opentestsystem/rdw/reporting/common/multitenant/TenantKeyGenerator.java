package org.opentestsystem.rdw.reporting.common.multitenant;

import org.springframework.cache.interceptor.KeyGenerator;

import java.lang.reflect.Method;
import java.util.StringJoiner;

/**
 * A custom key generator that prefixes with the current tenant id.
 * The resulting key includes the method name and stringified params.
 * For example, "CA_findAll".
 */
public class TenantKeyGenerator implements KeyGenerator {

    @Override
    public Object generate(final Object target, final Method method, final Object... params) {
        final StringJoiner joiner = new StringJoiner("_");
        joiner.add(StaticTenantIdUtil.tenantIdKey());
        joiner.add(method.getName());
        if (params != null && params.length > 0) {
            for (final Object param : params) {
                joiner.add(param.toString());
            }
        }
        return joiner.toString();
    }
}
