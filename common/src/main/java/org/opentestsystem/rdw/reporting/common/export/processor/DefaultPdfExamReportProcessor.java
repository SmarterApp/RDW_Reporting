package org.opentestsystem.rdw.reporting.common.export.processor;

import org.opentestsystem.rdw.reporting.common.ExamReport;
import org.opentestsystem.rdw.reporting.common.export.PdfExamReportRequest;

public class DefaultPdfExamReportProcessor implements PdfExamReportProcessor {

    private final TemplateProcessor templateProcessor;
    private final HtmlToPdfProcessor htmlToPdfProcessor;

    public DefaultPdfExamReportProcessor(
            final TemplateProcessor templateProcesor,
            final HtmlToPdfProcessor htmlToPdfProcessor) {
        this.templateProcessor = templateProcesor;
        this.htmlToPdfProcessor = htmlToPdfProcessor;
    }

    @Override
    public byte[] process(final ExamReport report, final PdfExamReportRequest request, final String templatePath) throws RuntimeException {
        final byte[] html = templateProcessor.process(templatePath, report, request.getLocale());
        return htmlToPdfProcessor.process(html, request.getOptions());
    }

}
