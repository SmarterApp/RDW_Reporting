package org.opentestsystem.rdw.reporting.common.export.processor;

import org.opentestsystem.rdw.reporting.common.ExamReport;
import org.opentestsystem.rdw.reporting.common.export.PdfExamReportRequest;

/**
 * Composite processor for model + template to html processing and html to pdf processing
 */
public class DefaultPdfExamReportProcessor implements PdfExamReportProcessor {

    private final TemplateProcessor templateProcessor;
    private final HtmlToPdfProcessor htmlToPdfProcessor;

    public DefaultPdfExamReportProcessor(
            final TemplateProcessor templateProcessor,
            final HtmlToPdfProcessor htmlToPdfProcessor) {
        this.templateProcessor = templateProcessor;
        this.htmlToPdfProcessor = htmlToPdfProcessor;
    }

    @Override
    public byte[] process(
            final ExamReport report,
            final PdfExamReportRequest request,
            final String templatePath) {
        final byte[] html = templateProcessor.process(templatePath, report, request.getLocale());
        return htmlToPdfProcessor.process(html, request.getOptions());
    }

}
