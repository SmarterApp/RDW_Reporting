package org.opentestsystem.rdw.reporting.common.report.processor;

import org.opentestsystem.rdw.reporting.common.report.PrintOptions;
import org.opentestsystem.rdw.reporting.common.report.client.Options;
import org.opentestsystem.rdw.reporting.common.report.client.Request;
import org.opentestsystem.rdw.reporting.common.report.client.WkhtmltopdfWebServiceClient;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

/**
 * This class invokes openlabs wkhtmltopdf REST API endpoint to convert HTML to PDF
 */
@Service
public class WkhtmltopdfWebServiceHtmlToPdfProcessor implements HtmlToPdfProcessor {

    private static final Options DEFAULT_OPTIONS = Options.builder()
            .dpi(276)
            .pageSize("Letter")
            .build();

    private final WkhtmltopdfWebServiceClient client;

    @Autowired
    WkhtmltopdfWebServiceHtmlToPdfProcessor(final WkhtmltopdfWebServiceClient client) {
        this.client = client;
    }

    @Override
    public byte[] process(final byte[] html, final PrintOptions options) {
        return client.toPdf(new Request(html, DEFAULT_OPTIONS));
    }

}
