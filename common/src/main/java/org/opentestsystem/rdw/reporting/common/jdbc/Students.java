package org.opentestsystem.rdw.reporting.common.jdbc;

import org.opentestsystem.rdw.reporting.common.model.Student;

import java.sql.ResultSet;
import java.sql.SQLException;

/**
 * Holds utility methods for mapping SQL query results to {@link Student}
 */
public final class Students {

    private Students() {
    }

    public static <T extends Student.Builder> T map(final ResultSet row, final T builder) throws SQLException {
        return map(row, builder, "");
    }

    public static <T extends Student.Builder> T map(final ResultSet row, final T builder, final String prefix) throws SQLException {
        builder.id(row.getLong(prefix + "id"))
                .ssid(row.getString(prefix + "ssid"))
                .firstName(row.getString(prefix + "first_name"))
                .lastName(row.getString(prefix + "last_name"))
                .genderCode(row.getString(prefix + "gender_code"));

        return builder;
    }

}
