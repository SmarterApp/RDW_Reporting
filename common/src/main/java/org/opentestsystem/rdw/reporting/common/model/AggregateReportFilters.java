package org.opentestsystem.rdw.reporting.common.model;

import com.google.common.collect.ImmutableSet;

import java.util.Set;

/**
 * This class represents student exam result filters for aggregate reports.
 */
public class AggregateReportFilters {
    private ImmutableSet<String> completenessCodes;
    private ImmutableSet<String> administrativeConditionCodes;
    private ImmutableSet<String> genderCodes;
    private ImmutableSet<String> ethnicityCodes;
    private ImmutableSet<String> lepCodes;
    private ImmutableSet<String> migrantStatusCodes;
    private ImmutableSet<String> section504Codes;
    private ImmutableSet<String> iepCodes;
    private ImmutableSet<String> economicDisadvantageCodes;

    public Set<String> getCompletenessCodes() {
        return getNullSafe(completenessCodes);
    }

    public Set<String> getAdministrativeConditionCodes() {
        return getNullSafe(administrativeConditionCodes);
    }

    public Set<String> getGenderCodes() {
        return getNullSafe(genderCodes);
    }

    public Set<String> getEthnicityCodes() {
        return getNullSafe(ethnicityCodes);
    }

    public Set<String> getLepCodes() {
        return getNullSafe(lepCodes);
    }

    public Set<String> getMigrantStatusCodes() {
        return getNullSafe(migrantStatusCodes);
    }

    public Set<String> getSection504Codes() {
        return getNullSafe(section504Codes);
    }

    public Set<String> getIepCodes() {
        return getNullSafe(iepCodes);
    }

    public Set<String> getEconomicDisadvantageCodes() {
        return getNullSafe(economicDisadvantageCodes);
    }

    private Set<String> getNullSafe(final Set<String> values) {
        return values == null ? ImmutableSet.of() : values;
    }

    public static Builder builder() {
        return new Builder();
    }

    public static class Builder {
        private Set<String> completenessCodes;
        private Set<String> administrativeConditionCodes;
        private Set<String> genderCodes;
        private Set<String> ethnicityCodes;
        private Set<String> lepCodes;
        private Set<String> migrantStatusCodes;
        private Set<String> section504Codes;
        private Set<String> iepCodes;
        private Set<String> economicDisadvantageCodes;

        public AggregateReportFilters build() {
            final AggregateReportFilters filters = new AggregateReportFilters();
            filters.completenessCodes = asImmutable(completenessCodes);
            filters.administrativeConditionCodes = asImmutable(administrativeConditionCodes);
            filters.genderCodes = asImmutable(genderCodes);
            filters.ethnicityCodes = asImmutable(ethnicityCodes);
            filters.lepCodes = asImmutable(lepCodes);
            filters.migrantStatusCodes = asImmutable(migrantStatusCodes);
            filters.section504Codes = asImmutable(section504Codes);
            filters.iepCodes = asImmutable(iepCodes);
            filters.economicDisadvantageCodes = asImmutable(economicDisadvantageCodes);
            return filters;
        }

        public Builder copy(final AggregateReportFilters filters) {
            this.completenessCodes = filters.completenessCodes;
            this.administrativeConditionCodes = filters.administrativeConditionCodes;
            this.genderCodes = filters.genderCodes;
            this.ethnicityCodes = filters.ethnicityCodes;
            this.lepCodes = filters.lepCodes;
            this.migrantStatusCodes = filters.migrantStatusCodes;
            this.section504Codes = filters.section504Codes;
            this.iepCodes = filters.iepCodes;
            this.economicDisadvantageCodes = filters.economicDisadvantageCodes;
            return this;
        }

        public Builder completenessCodes(final Set<String> completenessCodes) {
            this.completenessCodes = completenessCodes;
            return this;
        }

        public Builder administrativeConditionCodes(final Set<String> administrativeConditionCodes) {
            this.administrativeConditionCodes = administrativeConditionCodes;
            return this;
        }

        public Builder genderCodes(final Set<String> genderCodes) {
            this.genderCodes = genderCodes;
            return this;
        }

        public Builder ethnicityCodes(final Set<String> ethnicityCodes) {
            this.ethnicityCodes = ethnicityCodes;
            return this;
        }

        public Builder lepCodes(final Set<String> lepCodes) {
            this.lepCodes = lepCodes;
            return this;
        }

        public Builder migrantStatusCodes(final Set<String> migrantStatusCodes) {
            this.migrantStatusCodes = migrantStatusCodes;
            return this;
        }

        public Builder section504Codes(final Set<String> section504Codes) {
            this.section504Codes = section504Codes;
            return this;
        }

        public Builder iepCodes(final Set<String> iepCodes) {
            this.iepCodes = iepCodes;
            return this;
        }

        public Builder economicDisadvantageCodes(final Set<String> economicDisadvantageCodes) {
            this.economicDisadvantageCodes = economicDisadvantageCodes;
            return this;
        }

        private <T> ImmutableSet<T> asImmutable(final Set<T> values) {
            return values == null ? null : ImmutableSet.copyOf(values);
        }
    }
}
