package org.opentestsystem.rdw.reporting.common.model;

import com.google.common.collect.ImmutableSet;

import java.util.Set;

import static org.opentestsystem.rdw.reporting.common.util.CollectionUtils.safeImmutableOf;

/**
 * This class represents student exam result filters for aggregate reports.
 */
public class StudentFilters {

    private ImmutableSet<String> genderCodes;
    private ImmutableSet<String> ethnicityCodes;
    private ImmutableSet<String> lepCodes;
    private ImmutableSet<String> elasCodes;
    private ImmutableSet<String> languageCodes;
    private ImmutableSet<String> militaryConnectedCodes;
    private ImmutableSet<String> migrantStatusCodes;
    private ImmutableSet<String> section504Codes;
    private ImmutableSet<String> iepCodes;
    private ImmutableSet<String> economicDisadvantageCodes;

    public Set<String> getGenderCodes() {
        return safeImmutableOf(genderCodes);
    }

    public Set<String> getEthnicityCodes() {
        return safeImmutableOf(ethnicityCodes);
    }

    public Set<String> getLepCodes() {
        return safeImmutableOf(lepCodes);
    }

    public Set<String> getElasCodes() {
        return safeImmutableOf(elasCodes);
    }

    public Set<String> getLanguageCodes() {
        return safeImmutableOf(languageCodes);
    }

    public Set<String> getMilitaryConnectedCodes() { return safeImmutableOf(militaryConnectedCodes); }

    public Set<String> getMigrantStatusCodes() {
        return safeImmutableOf(migrantStatusCodes);
    }

    public Set<String> getSection504Codes() {
        return safeImmutableOf(section504Codes);
    }

    public Set<String> getIepCodes() {
        return safeImmutableOf(iepCodes);
    }

    public Set<String> getEconomicDisadvantageCodes() {
        return safeImmutableOf(economicDisadvantageCodes);
    }

    public static Builder builder() {
        return new Builder();
    }

    public static class Builder {
        private Set<String> genderCodes;
        private Set<String> ethnicityCodes;
        private Set<String> lepCodes;
        private Set<String> elasCodes;
        private Set<String> languageCodes;
        private Set<String> militaryConnectedCodes;
        private Set<String> migrantStatusCodes;
        private Set<String> section504Codes;
        private Set<String> iepCodes;
        private Set<String> economicDisadvantageCodes;

        public StudentFilters build() {
            final StudentFilters filters = new StudentFilters();
            filters.genderCodes = safeImmutableOf(genderCodes);
            filters.ethnicityCodes = safeImmutableOf(ethnicityCodes);
            filters.lepCodes = safeImmutableOf(lepCodes);
            filters.elasCodes = safeImmutableOf(elasCodes);
            filters.languageCodes = safeImmutableOf(languageCodes);
            filters.militaryConnectedCodes = safeImmutableOf(militaryConnectedCodes);
            filters.migrantStatusCodes = safeImmutableOf(migrantStatusCodes);
            filters.section504Codes = safeImmutableOf(section504Codes);
            filters.iepCodes = safeImmutableOf(iepCodes);
            filters.economicDisadvantageCodes = safeImmutableOf(economicDisadvantageCodes);
            return filters;
        }

        public Builder copy(final StudentFilters filters) {
            this.genderCodes = filters.genderCodes;
            this.ethnicityCodes = filters.ethnicityCodes;
            this.lepCodes = filters.lepCodes;
            this.elasCodes = filters.elasCodes;
            this.languageCodes = filters.languageCodes;
            this.militaryConnectedCodes = filters.militaryConnectedCodes;
            this.migrantStatusCodes = filters.migrantStatusCodes;
            this.section504Codes = filters.section504Codes;
            this.iepCodes = filters.iepCodes;
            this.economicDisadvantageCodes = filters.economicDisadvantageCodes;
            return this;
        }

        public Builder genderCodes(final Set<String> genderCodes) {
            this.genderCodes = genderCodes;
            return this;
        }

        public Builder ethnicityCodes(final Set<String> ethnicityCodes) {
            this.ethnicityCodes = ethnicityCodes;
            return this;
        }

        public Builder lepCodes(final Set<String> lepCodes) {
            this.lepCodes = lepCodes;
            return this;
        }

        public Builder elasCodes(final Set<String> elasCodes) {
            this.elasCodes = elasCodes;
            return this;
        }

        public Builder languageCodes(final Set<String> languageCodes) {
            this.languageCodes = languageCodes;
            return this;
        }

        public Builder militaryConnectedCodes(final Set<String> militaryConnectedCodes) {
            this.militaryConnectedCodes = militaryConnectedCodes;
            return this;
        }

        public Builder migrantStatusCodes(final Set<String> migrantStatusCodes) {
            this.migrantStatusCodes = migrantStatusCodes;
            return this;
        }

        public Builder section504Codes(final Set<String> section504Codes) {
            this.section504Codes = section504Codes;
            return this;
        }

        public Builder iepCodes(final Set<String> iepCodes) {
            this.iepCodes = iepCodes;
            return this;
        }

        public Builder economicDisadvantageCodes(final Set<String> economicDisadvantageCodes) {
            this.economicDisadvantageCodes = economicDisadvantageCodes;
            return this;
        }
    }
}
