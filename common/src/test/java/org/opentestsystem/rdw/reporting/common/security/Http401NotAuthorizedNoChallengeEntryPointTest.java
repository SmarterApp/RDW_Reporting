package org.opentestsystem.rdw.reporting.common.security;

import org.junit.Test;
import org.opentestsystem.rdw.reporting.common.security.Http401NotAuthorizedNoChallengeEntryPoint;
import org.springframework.security.core.AuthenticationException;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import static javax.servlet.http.HttpServletResponse.SC_UNAUTHORIZED;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.verify;

public class Http401NotAuthorizedNoChallengeEntryPointTest {

    @Test
    public void itShouldSendA401ErrorOnEntry() throws Exception {
        final HttpServletRequest request = mock(HttpServletRequest.class);
        final HttpServletResponse response = mock(HttpServletResponse.class);
        final AuthenticationException exception = mock(AuthenticationException.class);
        final Http401NotAuthorizedNoChallengeEntryPoint entryPoint = new Http401NotAuthorizedNoChallengeEntryPoint();

        entryPoint.commence(request, response, exception);

        verify(response).sendError(SC_UNAUTHORIZED, "Unauthorized");
    }

}