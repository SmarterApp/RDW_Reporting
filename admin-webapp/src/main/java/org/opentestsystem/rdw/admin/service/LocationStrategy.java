package org.opentestsystem.rdw.admin.service;

import java.util.StringJoiner;

/**
 * Strategy for creating archive locations
 * todo: move to common and incorporate with same in ingest, will also be used by processor.
 */
public interface LocationStrategy {
    String location(String id);

    /**
     * For upload content the id is a hex digest so it can be used to partition the files.
     * Given an id and this location strategy return a consistent unique location in a given deployed environment.
     */
    public static class GroupUploadContentLocationStrategy implements LocationStrategy {
        private final String GroupLocationPrefix = "GROUPS";

        public GroupUploadContentLocationStrategy() {
        }

        @Override
        public String location(final String id) {
            final StringJoiner joiner = new StringJoiner("/");
            joiner.add(GroupLocationPrefix);
            joiner.add(id.substring(0, 2));
            joiner.add(id.substring(2, 4));
            joiner.add(id);
            return joiner.toString();
        }
    }

}
