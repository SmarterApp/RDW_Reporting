package org.opentestsystem.rdw.reporting.security;

import org.junit.Before;
import org.junit.Test;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.security.web.firewall.DefaultHttpFirewall;
import org.springframework.security.web.firewall.HttpFirewall;

import javax.servlet.http.HttpServletRequest;

public class FirewallTest {

    private HttpFirewall firewall;

    @Before
    public void createFirewall() {
        firewall = new DefaultHttpFirewall();
//        firewall = new StrictHttpFirewall();
//        ((StrictHttpFirewall) firewall).setAllowSemicolon(true);
    }

    @Test
    public void itShouldAllowSemiColons() {
        final HttpServletRequest request = new MockHttpServletRequest("GET", "reporting.sbacdw.org/group-exams;schoolYear=2019;userGroupId=14");
        firewall.getFirewalledRequest(request);
    }

    @Test
    public void itShouldAllowDoubleSlash() {
        final HttpServletRequest request = new MockHttpServletRequest("POST", "reporting.sbacdw.org/iris//Pages/API/content/load?id=DEADBEEF");
        firewall.getFirewalledRequest(request);
    }
}
