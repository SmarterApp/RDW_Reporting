package org.opentestsystem.rdw.reporting.security.sandbox;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.authentication.AuthenticationManager;

@Configuration
//@Order(101) // greater than default 100 so saml config takes priority
public class SandboxSecurityConfiguration /*extends WebSecurityConfigurerAdapter*/ {

    @Bean
    public SandboxAuthenticationFilter sandboxAuthenticationFilter(
            final AuthenticationManager authenticationManager) {
        final SandboxAuthenticationFilter filter = new SandboxAuthenticationFilter("/sandbox/login");

        // required by AbstractAuthenticationProcessingFilter
        // provided by WebSecurityConfigurationAdapter
        filter.setAuthenticationManager(authenticationManager);
        return filter;
    }

    @Bean
    public SandboxUserDetailsService sandboxUserDetailsService() {
        return new SandboxUserDetailsService();
    }

    @Bean
    public SandboxAuthenticationProvider sandboxAuthenticationProvider(final SandboxUserDetailsService userDetailsService) {
        return new SandboxAuthenticationProvider(userDetailsService);
    }

}
