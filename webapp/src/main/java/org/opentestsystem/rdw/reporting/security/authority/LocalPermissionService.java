package org.opentestsystem.rdw.reporting.security.authority;

import org.opentestsystem.rdw.security.service.PermissionService;
import org.opentestsystem.rdw.security.service.PermissionServiceException;

import java.util.Collection;
import java.util.Map;

public class LocalPermissionService implements PermissionService {
    private final PermissionRepository permissionRepository;

    public LocalPermissionService(final PermissionRepository permissionRepository) {
        this.permissionRepository = permissionRepository;
    }

    @Override
    public Map<String, Collection<String>> getPermissionsByRole() throws PermissionServiceException {
        return (Map<String, Collection<String>>) permissionRepository.findAll();
    }
}
