package org.opentestsystem.rdw.reporting.model;

import com.google.common.base.MoreObjects;
import com.google.common.collect.ImmutableSet;

import java.util.Collection;
import java.util.Set;

/**
 * Used to limit database query results
 */
public class PermissionScope {

    /**
     * Statewide permission scope flyweight
     * Since all statewide permission scopes will be identical, we can use the same immutable object instance
     */
    public static final PermissionScope STATEWIDE = new PermissionScope();

    /**
     * Holds district entity IDs to which the permission is granted
     */
    private Set<Long> districtIds = ImmutableSet.of();

    /**
     * Holds institution entity IDs to which the permission is granted
     */
    private Set<Long> institutionIds = ImmutableSet.of();

    private PermissionScope() {
    }

    public PermissionScope(
            final Collection<Long> districtIds,
            final Collection<Long> institutionIds) {
        this.districtIds = districtIds != null ? ImmutableSet.copyOf(districtIds) : ImmutableSet.of();
        this.institutionIds = institutionIds != null ? ImmutableSet.copyOf(institutionIds) : ImmutableSet.of();
    }

    public boolean isStatewide() {
        return districtIds.isEmpty() && institutionIds.isEmpty();
    }

    public Set<Long> getDistrictIds() {
        return districtIds;
    }

    public Set<Long> getInstitutionIds() {
        return institutionIds;
    }

    @Override
    public String toString() {
        return MoreObjects.toStringHelper(this)
                .add("districtIds", getDistrictIds())
                .add("institutionIds", getInstitutionIds())
                .toString();
    }

}

