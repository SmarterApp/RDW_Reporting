package org.opentestsystem.rdw.reporting.security.authority;

import com.google.common.base.MoreObjects;
import org.opentestsystem.rdw.utils.Grant;

/**
 * Represents a tenancy chain grant provided by ART
 */
public class Authority {
    private String role;
    private Grant.Level level;
    private String entityId;
    private String stateId;

    public String getRole() {
        return role;
    }

    public Grant.Level getLevel() {
        return level;
    }

    public String getEntityId() {
        return entityId;
    }

    public String getStateId() {
        return stateId;
    }

    public static Builder builder() {
        return new Builder();
    }

    public String toString() {
        return MoreObjects.toStringHelper(this)
                .add("role", getRole())
                .add("level", getLevel())
                .add("entityId", getEntityId())
                .add("state", getStateId())
                .toString();
    }

    public static class Builder {
        private String role;
        private Grant.Level level;
        private String entityId;
        private String stateId;

        public Builder role(final String role) {
            this.role = role;
            return this;
        }

        public Builder level(final Grant.Level level) {
            this.level = level;
            return this;
        }

        public Builder entityId(final String entityId) {
            this.entityId = entityId;
            return this;
        }

        public Builder stateId(final String stateId) {
            this.stateId = stateId;
            return this;
        }

        public Authority build() {
            final Authority authority = new Authority();
            authority.level = level;
            authority.role = role;
            authority.entityId = entityId;
            authority.stateId = stateId;
            return authority;
        }
    }
}
