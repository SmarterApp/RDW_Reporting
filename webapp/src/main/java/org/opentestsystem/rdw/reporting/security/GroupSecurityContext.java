package org.opentestsystem.rdw.reporting.security;

/**
 * Holds all information necessary for group and tenancy chain based access controls
 */
public class GroupSecurityContext {

    private GroupGrant groupGrant;
    private PermissionScope permissionScope;

    public GroupSecurityContext(final GroupGrant groupGrant, final PermissionScope permissionScope) {
        this.groupGrant = groupGrant;
        this.permissionScope = permissionScope;
    }

    public GroupSecurityContext(final User user, final long groupId, final String permission) {
        this(user.getGroupsById().get(groupId), user.getPermissionsById().get(permission).getScope());
    }

    /**
     * @return the group security constraints
     */
    public GroupGrant getGroupGrant() {
        return groupGrant;
    }

    /**
     * @return the permission scope
     */
    public PermissionScope getPermissionScope() {
        return permissionScope;
    }

}
