package org.opentestsystem.rdw.reporting.security.authority;

import org.opentestsystem.rdw.utils.Grant;

import static com.google.common.base.Strings.emptyToNull;

/**
 * Support methods for {@link Authority}
 */
public final class Authorities {

    /**
     * Converts the provided {@link Grant} into an {@link Authority}
     *
     * @param grant The grant to convert
     * @return The resulting authority
     */
    public static Authority toAuthority(final Grant grant) {
        return Authority.builder()
                .role(emptyToNull(grant.getRole()))
                .level(grant.getLevel())
                .entityId(emptyToNull(grant.getEntityId()))
                .stateId(emptyToNull(grant.getStateId()))
                .build();
    }

    private Authorities() {}
}
