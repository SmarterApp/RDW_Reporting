<p>{{ 'item-scores.student-scores-intro-text' | translate }}</p>
<p-dataTable #datatable [value]="scores" tableStyleClass="table table-striped table-hover" [tableStyle]="{'table-layout':'auto'}" sortField="student.lastName" expandableRows="true" rowExpandMode="single">
  <p-column sortField="student.lastName" header="{{'common.results.assessment-exam-columns.name' | translate}}" [sortable]="true">
    <ng-template let-row="rowData" let-score="rowData" pTemplate="body">
      <datatable-row-expander [datatable]="datatable" [row]="row" [text]="'common.person-name' | translate:score.student"></datatable-row-expander>
    </ng-template>
  </p-column>
  <p-column field="date" header="{{'common.results.assessment-exam-columns.date' | translate}}" [sortable]="true">
    <ng-template let-score="rowData" pTemplate="body">
      {{ score.date | date }}
    </ng-template>
  </p-column>
  <p-column field="session" header="{{'common.results.assessment-exam-columns.session' | translate}}" [sortable]="true"></p-column>
  <p-column field="enrolledGrade" header="{{'common.results.assessment-exam-columns.grade' | translate}}" [sortable]="true">
    <ng-template let-score="rowData" pTemplate="body">
      {{ 'common.enrolled-grade-label.' + score.enrolledGrade | translate }}
    </ng-template>
  </p-column>
  <p-column field="school.name" header="{{'common.results.assessment-exam-columns.school' | translate }}" [sortable]="true"></p-column>
  <p-column *ngIf="includeResponse" field="response" header="{{'item-scores.response' | translate}}" [sortable]="true"></p-column>
  <p-column *ngIf="includeWritingTraitScores" field="writingTraitScores.evidence" header="{{'common.writing-trait.evidence' | translate}}" [sortable]="true">
    <ng-template let-score="rowData" pTemplate="body">
      <div class="text-center">{{ (score.writingTraitScores ? score.writingTraitScores.evidence : null) | optional }}</div>
    </ng-template>
  </p-column>
  <p-column *ngIf="includeWritingTraitScores" field="writingTraitScores.organization" header="{{'common.writing-trait.organization' | translate}}" [sortable]="true">
    <ng-template let-score="rowData" pTemplate="body">
      <div class="text-center">{{ (score.writingTraitScores ? score.writingTraitScores.organization : null) | optional }}</div>
    </ng-template>
  </p-column>
  <p-column *ngIf="includeWritingTraitScores" field="writingTraitScores.conventions" header="{{'common.writing-trait.conventions' | translate}}" [sortable]="true">
    <ng-template let-score="rowData" pTemplate="body">
      <div class="text-center">{{ (score.writingTraitScores ? score.writingTraitScores.conventions : null) | optional }}</div>
    </ng-template>
  </p-column>
  <p-column field="score" header="{{(includeWritingTraitScores ? 'common.writing-trait.total' : 'itemscores.score') | translate}}" [sortable]="true">
    <ng-template pTemplate="header">
      <span *ngIf="includeWritingTraitScores" info-button title="{{'common.writing-trait.total' | translate}}"
            content="{{'common.writing-trait.total-info' | translate}}"></span>
      <span *ngIf="!includeWritingTraitScores">{{ 'item-scores.score' | translate}}</span>
    </ng-template>
    <ng-template let-score="rowData" pTemplate="body">
      <div class="text-center">{{ score.score | optional }}</div>
    </ng-template>
  </p-column>
  <p-column *ngIf="!includeWritingTraitScores" field="maxScore" header="{{'item-scores.max' | translate}}" [sortable]="true">
    <ng-template let-score="rowData" pTemplate="body">
      <div class="text-center">{{ score.maxScore }}</div>
    </ng-template>
  </p-column>
  <p-column *ngIf="!includeWritingTraitScores" field="correctness" header="{{'item-scores.correctness' | translate}}" [sortable]="true">
    <ng-template let-correctness="rowData.correctness" pTemplate="body">
      <div class="text-center">{{ correctness | number:'1.2-2' }}</div>
    </ng-template>
  </p-column>
  <ng-template let-score pTemplate="rowexpansion">
    <div class="tab-content well">
      <item-viewer [item]="item"
                   [response]="score.response"
                   [position]="item.position"></item-viewer>
    </div>
  </ng-template>
</p-dataTable>
