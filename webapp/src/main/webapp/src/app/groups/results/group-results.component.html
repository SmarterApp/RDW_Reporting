<div class="pad-top-20">
  <h3>{{'labels.groups.name' | translate}}</h3>
  <div class="well-group">
    <div id="group-results-basic-filters" class="well">
      <div class="well-body row">
        <div class="col-md-4">
          <label for="select-group">{{'labels.groups.results.select-group' | translate}}</label>
          <!--TODO: type ahead? -->
          <select id="select-group" [(ngModel)]="currentGroup" (change)="updateRoute($event)" class="dropdown form-control">
            <option *ngFor="let group of groups" [ngValue]="group">{{group.name}}</option>
          </select>
        </div>
        <div class="col-md-2">
          <label for="school-year">{{'labels.groups.results.select-year' | translate}}</label>
          <select id="school-year" [(ngModel)]="currentSchoolYear" (change)="updateRoute($event)" class="dropdown form-control">
            <option *ngFor="let year of filterOptions.schoolYears" [ngValue]="year">{{year | schoolYear}}</option>
          </select>
        </div>
        <div class="col-md-6">
          <div class="pull-right">
            <label for="advanced">{{'labels.groups.results.adv-filters.label'  | translate}}</label>
            <button id="advanced" class="form-control" (click)="showAdvancedFilters = !showAdvancedFilters">
              {{'buttons.visibility.' + (showAdvancedFilters ? 'hide' : 'show') | translate}}
              <i class="fa" [ngClass]="{'fa-chevron-up': showAdvancedFilters, 'fa-chevron-down': !showAdvancedFilters}" aria-hidden="true"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
    <div id="group-results-adv-filters" [hidden]="!showAdvancedFilters" class="well gray-lightest">
      <h4>
        <i class="fa fa-check-square"></i> {{'labels.groups.results.adv-filters.label' | translate }}
        <div id="adv-filters-expand-collapse" class="pull-right">
          <button class="form-control btn btn-sm" (click)="expandFilterOptions = !expandFilterOptions">
            {{'buttons.collapsible.' + (expandFilterOptions ? 'collapse' : 'expand') | translate }}
            <i class="fa" [ngClass]="{'fa-chevron-up': expandFilterOptions, 'fa-chevron-down': !expandFilterOptions}" aria-hidden="true"></i>
          </button>
        </div>

      </h4>
      <div id="adv-filters-selected" class="flex-children">
          <div *ngFor="let property of clientFilterBy.all">
            <a class="tag aqua reverse slim" (click)="removeFilter(property)">
              <span *ngIf="property.indexOf('ethnicities') == -1">
                <strong>{{ filters[property].enumValue + '.' + clientFilterBy[property] | translate}}</strong> {{ filters[property].label | translate }}
              </span>
              <span *ngIf="property.indexOf('ethnicities') != -1">
                <strong>{{ filters['ethnicities'].enumValue + property.substring(property.indexOf('.')) | translate}}</strong> {{ filters['ethnicities'].label | translate }}
              </span>
              <span class="icon"><i class="fa fa-close"></i></span>
            </a>
          </div>
      </div>
    </div>
    <div id="group-results-adv-filter-options" [hidden]="!expandFilterOptions" class="well gray-lighter">
      <adv-filters [filterBy]="clientFilterBy" [filterOptions]="filterOptions"></adv-filters>
    </div>
    <div id="group-results-selected-assessments" class="well gray-lightest">
      <div class="well-body">
        <h4 class="margin-bottom-0">
          <i class="fa fa-list-alt"></i> {{'labels.groups.results.selected-assessments-title' | translate}}
          <div class="pull-right">
            <div class="btn-group" role="group">
              <button type="radio" (click)="showOnlyMostRecent = true" class="btn btn-default" [ngClass]="{'active': showOnlyMostRecent}">{{'labels.groups.results.filter-type-recent' |
                translate}}
              </button>
              <button type="radio" (click)="showOnlyMostRecent = false" class="btn btn-default" [ngClass]="{'active': !showOnlyMostRecent}">{{'labels.groups.results.filter-type-custom' | translate}}
              </button>
            </div>
          </div>
        </h4>
        <!-- TODO: Remove custom styles -->
        <div style="margin-bottom:20px !important;">
          <small>{{'labels.groups.results.selected-assessments-instruct' | translate }}</small>
        </div>
        <!-- TODO: Remove custom styles -->
        <a *ngFor="let assessment of selectedAssessments" (click)="removeAssessment(assessment)" class="tag {{getGradeColor(assessment.grade)}} slim" style="margin-right: 10px; margin-bottom:10px;">
          <span class="label">{{'labels.groups.results.grade-prefix' | translate}}{{assessment.grade}}</span>
          {{assessment.name}}
          <span class="icon"><i class="fa fa-close"></i></span>
        </a>
        <!-- TODO: Remove custom styles -->
        <a class="btn btn-default icon-only" (click)="expandAssessments=true" style="margin-bottom:17px;">
          <i class="fa fa-plus color-gray"></i>
        </a>
      </div>
    </div>
    <div id="group-results-edit-assessments" [hidden]="!expandAssessments" class="well gray-lighter">
      <div id="adv-filters-edit-assessments-collapse" class="pull-right">
        <button class="form-control btn btn-sm" (click)="expandAssessments = false">
          {{'buttons.collapsible.collapse' | translate }}
          <i class="fa fa-chevron-up" aria-hidden="true"></i>
        </button>
      </div>
      <select-assessments [assessments]="availableAssessments" (selectedAssessmentsChanged)="selectedAssessmentsChanged($event)"></select-assessments>
    </div>
  </div>

  <div>
    <h2>{{'labels.groups.results.title' | translate}}</h2>
    <div class="pull-right">
      <label for="value-format">{{'labels.groups.results.value-as' | translate }} </label>
      <div id="value-format" class="btn-group" role="group">
        <button type="radio" (click)="showValuesAsPercent = true" [ngClass]="{'active':showValuesAsPercent}" class="btn btn-default btn-sm"  >{{'labels.groups.results.value-as-percent' | translate}}</button>
        <button type="radio" (click)="showValuesAsPercent = false" [ngClass]="{'active':!showValuesAsPercent}" class="btn btn-default btn-sm">{{'labels.groups.results.value-as-number' | translate}}</button>
      </div>
    </div>
  </div>
  <div *ngFor="let assessment of assessmentExams">
    <assessment-results [assessmentExam]="assessment" [showValuesAsPercent]="showValuesAsPercent" [filterBy]="clientFilterBy"></assessment-results>
  </div>
  <div *ngIf="selectedAssessments.length == 0">
    <p>
      {{'messages.no-results-found' | translate}}
    </p>
  </div>
</div>
