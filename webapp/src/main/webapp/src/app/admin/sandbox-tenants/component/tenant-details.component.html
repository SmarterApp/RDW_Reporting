<div class="sandbox-container">
  <div class="sandbox-header">
    <div class="heading">
      <h2>
        {{ tenant.label }} <span class="sandbox-key">({{ tenant.code }})</span>
      </h2>
    </div>

    <div class="controls">
      <ng-container *ngIf="!editMode; else openControls">
        <a href="javascript:void(0)" (click)="editClicked()">
          <i class="fa fa-edit fa-2x"></i>
        </a>
      </ng-container>

      <ng-template #openControls>
        <button
          *hasPermission="'TENANT_WRITE'"
          class="btn btn-primary mr-xs"
          (click)="onSubmit()"
          [disabled]="tenantForm.invalid"
        >
          {{ 'common.action.save' | translate }}
        </button>
        <button class="btn btn-default mr-xs" (click)="cancelClicked()">
          {{ 'common.action.cancel' | translate }}
        </button>
        <p-menu #menu [popup]="true" [model]="menuItems"></p-menu>
        <button
          *hasPermission="'TENANT_WRITE'"
          type="button"
          pButton
          class="btn btn-primary btn-outlined"
          label="Show"
          (click)="menu.toggle($event)"
        >
          <i class="fa fa-list fa-xl"></i>
        </button>
      </ng-template>
    </div>
  </div>

  <ng-container *ngIf="!editMode; else openBody">
    <p *ngIf="!editMode" class="description">{{ tenant.description }}</p>
  </ng-container>
  <ng-template #openBody>
    <form class="form-group" [formGroup]="tenantForm">
      <div class="row mb-xs">
        <div class="col-md-4">
          <label>{{ 'tenant-config.fields.label' | translate }}</label>
        </div>
        <div class="col-md-8">
          <input
            *ngIf="!readonly"
            type="text"
            class="form-control"
            name="label"
            formControlName="label"
          />
          <span *ngIf="readonly">
            {{ tenant.label }}
          </span>
        </div>
      </div>
      <div class="row mb-xs">
        <div class="col-md-4">
          <label>{{ 'sandbox-config.fields.description' | translate }}</label>
        </div>
        <div class="col-md-8">
          <textarea
            *ngIf="!readonly"
            class="form-control"
            name="description"
            formControlName="description"
          >
          </textarea>
          <span *ngIf="readonly">
            {{ tenant.description }}
          </span>
        </div>
      </div>

      <p-accordion [multiple]="true">
        <p-accordionTab
          header="{{
            'sandbox-config.fields.configuration-properties' | translate
          }}"
        >
          <property-override-tree-table
            [form]="tenantForm"
            [configurationProperties]="tenant.configurationProperties"
            [readonly]="readonly"
            propertiesArrayName="configurationProperties"
          >
          </property-override-tree-table>
        </p-accordionTab>
        <p-accordionTab
          header="{{
            'sandbox-config.fields.localization-overrides' | translate
          }}"
        >
          <property-override-table
            [form]="tenantForm"
            [configurationProperties]="localizationOverrides"
            [readonly]="readonly"
            propertiesArrayName="localizationOverrides"
          >
          </property-override-table>
        </p-accordionTab>
      </p-accordion>
    </form>
  </ng-template>
</div>
