<!-- TODO extract -->
<div class="controls">
  <input
    id="search"
    name="search"
    type="text"
    placeholder="{{
      'tenant-form.field.localizationOverrides.control.search.placeholder'
        | translate
    }}"
    class="form-control"
    (input)="table.filterGlobal($event, 'contains')"
  />
  <label>
    <input
      id="modified"
      name="modified"
      type="checkbox"
      [(ngModel)]="modified"
      (ngModelChange)="updatePropertiesFilter()"
    />
    {{
      'tenant-form.field.localizationOverrides.control.modified.label'
        | translate
    }}
  </label>
</div>

<div [formGroup]="form">
  <div [formArrayName]="propertiesArrayName">
    <p-table
      #table
      [value]="filteredConfigurationProperties"
      dataKey="key"
      [globalFilterFields]="['key', 'value']"
      styleClass="table table-striped table-hover overflow rdw-scrollable-table"
      [paginator]="true"
      [(first)]="first"
      [alwaysShowPaginator]="false"
      [rows]="20"
      [rowTrackBy]="rowTrackBy"
    >
      <ng-template pTemplate="header">
        <tr>
          <th>
            {{
              'tenant-localization-override-form.column.key.label' | translate
            }}
          </th>
          <th>
            {{
              'tenant-localization-override-form.column.value.label' | translate
            }}
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-overrides>
        <tr
          *ngIf="!readonly"
          [ngClass]="{
            modified: overrides.value !== overrides.originalValue
          }"
          (click)="overrideInput.focus()"
        >
          <td [title]="overrides.key">{{ overrides.key }}</td>
          <td>
            <input
              #overrideInput
              type="text"
              [value]="overrides.value"
              [formControlName]="overrides.key"
              class="property-input"
              (change)="updateOverride(overrides)"
            />
            <div class="icon-container">
              <i
                class="fa fa-undo fa-md"
                *ngIf="overrides.value !== overrides.originalValue && !readonly"
                (click)="resetClicked(overrides)"
                popover="{{
                  'tenant-configuration-override-form.popover.reset' | translate
                }}"
                placement="left"
                container="body"
                triggers="mouseenter:mouseleave"
              ></i>
            </div>
          </td>
        </tr>
        <tr
          *ngIf="readonly"
          [ngClass]="{
            modified: overrides.value !== overrides.originalValue
          }"
        >
          <td [title]="overrides.key">{{ overrides.key }}</td>
          <td>
            <span>
              {{ overrides.value }}
            </span>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="2">
            {{ 'tenant-localization-override-form.no-results' | translate }}
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
