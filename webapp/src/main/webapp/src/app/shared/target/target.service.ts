import { Injectable } from '@angular/core';
import { ReportingServiceRoute } from '../service-route';
import { catchError, map } from 'rxjs/operators';
import { ResponseUtils } from '../response-utils';
import { AssessmentExamMapper } from '../../assessments/assessment-exam.mapper';
import { DataService } from '../data/data.service';
import { Observable } from "rxjs/Observable";

const ServiceRoute = ReportingServiceRoute;

@Injectable()
export class TargetService  {
  constructor(private dataService: DataService,
              private mapper: AssessmentExamMapper) {
  }

  getTargetsForAssessment(assessmentId: number) {
    //TODO FOR DEBUGGING
    if (assessmentId === 199) {
      return Observable.of(this.mapper.mapTargetsFromApi(
        [{"id":20,"assessmentId":199,"claimCode":"1","naturalId":"EE|E-6","code":"E-6","description":"Apply and extend previous understandings of arithmetic to algebraic expressions.","includeInReport":true},{"id":21,"assessmentId":199,"claimCode":"1","naturalId":"EE|F-6","code":"F-6","description":"Reason about and solve one-variable equations and inequalities.","includeInReport":true},{"id":22,"assessmentId":199,"claimCode":"1","naturalId":"EE|G-6","code":"G-6","description":"Represent and analyze quantitative relationships between dependent and independent variables.","includeInReport":true},{"id":53,"assessmentId":199,"claimCode":"1","naturalId":"G|H-6","code":"H-6","description":"Solve real-world and mathematical problems involving area, surface area, and volume.","includeInReport":true},{"id":112,"assessmentId":199,"claimCode":"1","naturalId":"NS|C-6","code":"C-6","description":"Compute fluently with muti-digit numbers and find common factors and multiples.","includeInReport":true},{"id":113,"assessmentId":199,"claimCode":"1","naturalId":"NS|D-6","code":"D-6","description":"Apply and extend previous understandings of numbers to the system of rational numbers.","includeInReport":true},{"id":131,"assessmentId":199,"claimCode":"1","naturalId":"RP|A-6","code":"A-6","description":"Understand ration concepts and use ratio reasoning to solve problems.","includeInReport":true},{"id":146,"assessmentId":199,"claimCode":"1","naturalId":"SP|J-6","code":"J-6","description":"Summarize and describe distributions.","includeInReport":true}]
        )
      );
    }
    if (assessmentId === 140) {
      return Observable.of(this.mapper.mapTargetsFromApi(
        [{"id":750,"assessmentId":140,"claimCode":"1-IT","naturalId":"10-6","code":"10-6","description":"WORD MEANINGS: Determine intended or precise meanings of words, including domain-specific (tier 3) words and words with multiple meanings (academic/tier 2 words), based on context, word relationships (e.g., antonyms, homographs), word structure (e.g., common Greek or Latin roots, affixes), or use of resources (e.g., dictionary, glossary, digital tools)","includeInReport":true},{"id":763,"assessmentId":140,"claimCode":"1-IT","naturalId":"11-6","code":"11-6","description":"REASONING & EVIDENCE: Use supporting evidence to justify interpretations or analyses of information presented or how information is integrated within a text (point of view; interactions among events, concepts, people, or ideas; author’s reasoning and evidence)","includeInReport":true},{"id":789,"assessmentId":140,"claimCode":"1-IT","naturalId":"13-6","code":"13-6","description":"TEXT STRUCTURES & FEATURES: Relate knowledge of text structures or genre-specific features to analyze or integrate information","includeInReport":true},{"id":802,"assessmentId":140,"claimCode":"1-IT","naturalId":"14-6","code":"14-6","description":"LANGUAGE USE: Interpret intent or impact of figurative language (e.g., hyperbole, personification, analogies), use of literary devices, or connotative meanings of words and phrases used in context","includeInReport":true},{"id":815,"assessmentId":140,"claimCode":"1-IT","naturalId":"8-6","code":"8-6","description":"KEY DETAILS: Use explicit details and implicit information from texts to support inferences or analyses of the information presented","includeInReport":true},{"id":828,"assessmentId":140,"claimCode":"1-IT","naturalId":"9-6","code":"9-6","description":"CENTRAL IDEAS: Summarize central ideas, key events, procedures, or topics and subtopics","includeInReport":true},{"id":850,"assessmentId":140,"claimCode":"1-LT","naturalId":"2-6","code":"2-6","description":"CENTRAL IDEAS: Summarize central ideas/ key events","includeInReport":true},{"id":861,"assessmentId":140,"claimCode":"1-LT","naturalId":"3-6","code":"3-6","description":"WORD MEANINGS: Determine intended, precise, or nuanced meanings of words, including words with multiple meanings (academic/tier 2 words), based on context, word patterns, parts of speech, or use of resources (e.g., dictionary, thesaurus, digital tools)","includeInReport":true},{"id":872,"assessmentId":140,"claimCode":"1-LT","naturalId":"4-6","code":"4-6","description":"REASONING & EVIDENCE: Apply reasoning and a range of textual evidence (e.g., quotes, examples, details) to justify analyses or judgments made about intended effects (techniques used to advance action or create an effect; points of view; development of theme, characters, setting, plot)","includeInReport":true},{"id":883,"assessmentId":140,"claimCode":"1-LT","naturalId":"5-6","code":"5-6","description":"ANALYSIS WITHIN OR ACROSS TEXTS: Analyze how information is presented within or across texts showing relationships among the targeted aspects (the influence of differing points of view, various formats/media, use of source material)","includeInReport":true},{"id":894,"assessmentId":140,"claimCode":"1-LT","naturalId":"6-6","code":"6-6","description":"TEXT STRUCTURES & FEATURES: Relate knowledge of text structures or text features (e.g., layout; visual or auditory elements – lighting, camera effects, music; symbolic or graphic representations) to analyze impact on meaning, style, or presentation","includeInReport":true},{"id":918,"assessmentId":140,"claimCode":"2-W","naturalId":"1-6","code":"1-6","description":"WRITE/REVISE BRIEF TEXTS: Apply narrative strategies (e.g., dialogue, description) and appropriate text structures and transitions when writing or revising one or more paragraphs of narrative text (e.g., introduce narrator or use dialogue when describing an event)","includeInReport":true},{"id":957,"assessmentId":140,"claimCode":"2-W","naturalId":"3-6","code":"3-6","description":"WRITE/REVISE BRIEF TEXTS: Apply a variety of strategies when writing or revising one or more paragraphs of informational text: organizing ideas by stating and maintaining a focus/tone, developing a topic including relevant supporting evidence/ vocabulary and elaboration, or providing a conclusion appropriate to purpose and audience","includeInReport":true},{"id":1009,"assessmentId":140,"claimCode":"2-W","naturalId":"7-6","code":"7-6","description":"COMPOSE FULL TEXTS: Write full arguments about topics or texts, attending to purpose and audience: establish and support a claim, organize and cite supporting (text) evidence from credible sources, and provide a conclusion","includeInReport":true},{"id":1022,"assessmentId":140,"claimCode":"2-W","naturalId":"8-6","code":"8-6","description":"LANGUAGE & VOCABULARY USE: Strategically use precise language and vocabulary (including academic words and domain-specific vocabulary figurative language,) and style appropriate to the purpose and audience when revising or composing texts","includeInReport":true},{"id":1035,"assessmentId":140,"claimCode":"2-W","naturalId":"9-6","code":"9-6","description":"EDIT/CLARIFY: Apply or edit grade-appropriate grammar usage and mechanics to clarify a message and edit narrative, informational, and persuasive texts","includeInReport":true},{"id":1048,"assessmentId":140,"claimCode":"3-L","naturalId":"4-6","code":"4-6","description":"LISTEN/INTERPRET: Analyze, interpret, and use information delivered orally or visually","includeInReport":true},{"id":1113,"assessmentId":140,"claimCode":"4-CR","naturalId":"2-6","code":"2-6","description":"ANALYZE/INTEGRATE INFORMATION: Analyze information within and among sources of information (print and non-print texts, data sets, conducting procedures, etc.)","includeInReport":true},{"id":1126,"assessmentId":140,"claimCode":"4-CR","naturalId":"3-6","code":"3-6","description":"EVALUATE INFORMATION/SOURCES: Use reasoning, planning, and evidence to gather and select information to support inferences, interpretations, and analyses","includeInReport":true},{"id":1139,"assessmentId":140,"claimCode":"4-CR","naturalId":"4-6","code":"4-6","description":"USE EVIDENCE: Cite evidence to support analyses, arguments, or critiques","includeInReport":true}]
        )
      );
    }
    return this.dataService.get(`${ServiceRoute}/assessment-targets`, {
      params: {
        id: assessmentId
      }
    }).pipe(
      catchError(ResponseUtils.badResponseToNull),
      map(serverTargets => this.mapper.mapTargetsFromApi(serverTargets))
    );
  }
}
