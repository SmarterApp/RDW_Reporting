<p-table
  [columns]="columns"
  [value]="rows"
  [autoLayout]="true"
  sortField="report.created"
  [sortOrder]="-1"
  dataKey="id"
  styleClass="table table-striped table-hover"
>
  <ng-template pTemplate="header" let-columns>
    <tr>
      <th
        *ngFor="let column of columns"
        [pSortableColumn]="column.sortField"
        [ngSwitch]="column.id"
      >
        <div *ngSwitchDefault>
          {{ 'user-report-table.column.' + column.id + '.heading' | translate }}
        </div>

        <p-sortIcon [field]="column.sortField"></p-sortIcon>
      </th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-row let-columns="columns">
    <tr>
      <td *ngFor="let column of columns" [ngSwitch]="column.id">
        <ng-template
          *ngSwitchCase="'name'"
          [ngTemplateOutlet]="nameTemplate || defaultNameTemplate"
          [ngTemplateOutletContext]="row"
        ></ng-template>

        <span *ngSwitchCase="'type'" style="width: 285px;">
          {{ 'reports.report-type.' + row.report.query.type | translate }}
        </span>

        <ng-container *ngSwitchCase="'assessmentTypes'">
          {{
            (row.report.query.assessmentTypeCode
              ? 'common.assessment-type.' +
                row.report.query.assessmentTypeCode +
                '.short-name'
              : 'reports.all') | translate
          }}
        </ng-container>

        <span *ngSwitchCase="'subjects'" [title]="subjectName(row)">
          {{ subjectName(row) }}
        </span>

        <span *ngSwitchCase="'schoolYears'" [title]="academicYears(row)">
          {{ academicYears(row) | translate }}
        </span>

        <span
          *ngSwitchCase="'status'"
          class="label border-only"
          [ngClass]="{
            'blue-dark': row.report.status === 'COMPLETED',
            aqua:
              row.report.status === 'PENDING' ||
              row.report.status === 'RUNNING',
            maroon:
              row.report.status === 'FAILED' ||
              row.report.status === 'NO_RESULTS'
          }"
        >
          {{ 'reports.status.' + row.report.status | translate }}
        </span>

        <ng-container *ngSwitchCase="'created'">
          {{ row.report.created | date: 'medium' }}
        </ng-container>
      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="emptymessage" let-columns>
    <tr>
      <td [attr.colspan]="columns.length">
        {{ 'common.no-results' | translate }}
      </td>
    </tr>
  </ng-template>
</p-table>

<ng-template #defaultNameTemplate let-userReport="report">
  {{ userReport.label }}
</ng-template>
