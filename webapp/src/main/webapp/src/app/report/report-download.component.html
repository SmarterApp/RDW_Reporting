<div bsModal class="modal fade"
     #modal="bs-modal"
     tabindex="-1"
     role="dialog"
     aria-labelledby="report-download-modal"
     aria-hidden="true"
     (onShow)="onShowInternal($event)">

  <div *ngIf="modal.isShown"
       class="modal-dialog modal-md">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title pull-left">{{title}}</h4>
        <button type="button"
                class="close pull-right"
                aria-label="Close"
                (click)="modal.hide()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body text-left">
        <div class="row">
          <div class="col-md-6">

            <div class="form-group" [ngClass]="{'has-error': resourceControl.invalid && (resourceControl.dirty || resourceControl.touched)}">
              <label for="report-name">{{'common.reports.form.report-name' | translate}}</label>
              <input id="report-name"
                     #resourceControl="ngModel"
                     name="report-name"
                     class="form-control input-sm"
                     type="text"
                     maxlength="255"
                     [(ngModel)]="options.name"
                     [attr.aria-invalid]="resourceControl.invalid && (resourceControl.dirty || resourceControl.touched) && resourceControl.errors.required"
                     required>
            </div>
            <div *ngIf="resourceControl.invalid && (resourceControl.dirty || resourceControl.touched)">
              <p *ngIf="resourceControl.errors.required"
                 aria-live="polite"
                 class="help-block small red">{{'common.form-field-message.required' | translate}}</p>
            </div>

            <div class="form-group">
              <label for="assessment-type-select">{{'report-download.form.assessment-type' | translate}}</label>
              <div *ngIf="lockAssessmentType && options.assessmentType">
                <span>{{'common.assessment-type.' + options.assessmentType + '.short-name' | translate}}</span>
              </div>
              <select *ngIf="!lockAssessmentType"
                      id="assessment-type-select"
                      class="form-control input-sm"
                      name="assessment-type"
                      [(ngModel)]="options.assessmentType">
                <option *ngFor="let type of assessmentTypes"
                        [ngValue]="type">{{(type != null ? 'common.assessment-type.' + type + '.short-name' : 'common.collection-selection.all') | translate}}</option>
              </select>
            </div>

            <div class="form-group" *ngIf="displayOrder">
              <label for="order-select">{{'report-download.form.order' | translate}}</label>
              <select id="order-select"
                      class="form-control input-sm"
                      name="order"
                      [(ngModel)]="options.order">
                <option *ngFor="let order of orders"
                        [ngValue]="order">{{'report-download.orders.' + order | translate}}
                </option>
              </select>
            </div>

            <div class="form-group"
                 *ngIf="reportLanguages.length > 1">
              <label for="language-select">{{'report-download.form.language-header' | translate}}</label>
              <select id="language-select"
                      class="form-control input-sm"
                      name="language"
                      [(ngModel)]="options.language">
                <option *ngFor="let language of reportLanguages"
                        [ngValue]="language">{{'report-download.form.language-option.' + language | translate}}</option>
              </select>
            </div>

            <div class="form-group"
                 *ngIf="transferAccess">
              <fieldset>
                <label for="report-transfer-assessment-toggle">
                  <span info-button
                        title="{{'common.filters.test.transfer-assessment' | translate}}"
                        content="{{'common.filters.test.transfer-assessment-info' | translate}}"></span>
                </label>
                <sb-radio-button-group id="report-transfer-assessment-toggle"
                           name="report-transfer-assessment-toggle"
                           [(ngModel)]="options.disableTransferAccess"
                           [options]="[
                             {value: false, text: 'common.action.show' | translate},
                             {value: true, text: 'common.action.hide' | translate}
                           ]"></sb-radio-button-group>
              </fieldset>
            </div>

          </div>
          <div class="col-md-6">

            <div class="form-group">
              <label for="school-year-select">{{'common.school-year-select-label' | translate}}</label>
              <div *ngIf="lockSchoolYear && options.schoolYear">
                <span>{{options.schoolYear | schoolYear}}</span>
              </div>
              <select *ngIf="!lockSchoolYear"
                      id="school-year-select"
                      class="form-control input-sm"
                      name="school-year"
                      [(ngModel)]="options.schoolYear">
                <option *ngFor="let year of schoolYears" [ngValue]="year">{{year | schoolYear}}</option>
              </select>
            </div>

            <div class="form-group">
              <label for="subject-select">{{'common.subject-select-label' | translate}}</label>
              <div *ngIf="lockSubject && options.subject">
                <span>{{'subject.' + options.subject + '.name' | translate}}</span>
              </div>
              <select *ngIf="!lockSubject"
                      id="subject-select"
                      class="form-control input-sm"
                      name="subject"
                      [(ngModel)]="options.subject">
                <option *ngFor="let subject of subjectTypes"
                        [ngValue]="subject">{{(subject != null ? 'subject.' + subject + '.name' : 'common.collection-selection.all') | translate}}</option>
              </select>
            </div>

            <div class="form-group">
              <fieldset>
                <label for="accommodations-toggle">
                  <span info-button
                        title="{{'report-download.form.accommodations-title' | translate}}"
                        content="{{'report-download.form.accommodations-info' | translate}}"></span>
                </label>
                <sb-radio-button-group id="accommodations-toggle"
                           name="accommodations-toggle"
                           [(ngModel)]="options.accommodationsVisible"
                           [disabled]="options.assessmentType === 'iab'"
                           [options]="[
                             {value: true, text: 'common.action.show' | translate},
                             {value: false, text: 'common.action.hide' | translate}
                           ]"></sb-radio-button-group>
              </fieldset>
            </div>

          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" [disabled]="resourceControl.invalid"
                (click)="modal.hide(); submit()">{{'report-download.form.submit' | translate}}</button>
        <button class="btn btn-default"
                (click)="modal.hide()">{{'report-download.form.cancel' | translate}}</button>
      </div>
    </div>
  </div>
</div>
