<form *ngIf="formGroup" [formGroup]="formGroup" (ngSubmit)="onSubmit()">
  <div class="fields">
    <ng-container *ngFor="let field of fields">
      <div
        *ngIf="formGroup.get(field.name) as control"
        class="form-group {{ field.name }}"
        [ngClass]="{
          'has-error': control.invalid && (control.dirty || control.touched)
        }"
      >
        <label for="{{ field.name }}">
          <ng-container *ngIf="field.info; else label">
            <span
              info-button
              title="{{ field.info.title }}"
              content="{{ field.info.content }}"
            ></span>
          </ng-container>
          <ng-template #label>
            {{ field.label }}
          </ng-template>
        </label>

        <ng-container *ngIf="isReadonly(field); else writable">
          <div>{{ getReadonlyValue(field) }}</div>
        </ng-container>
        <ng-template #writable>
          <ng-container [ngSwitch]="field.type">
            <input
              *ngSwitchCase="'input'"
              class="form-control input-sm"
              id="{{ field.name }}"
              name="{{ field.name }}"
              placeholder="{{ field.placeholder }}"
              [formControl]="control"
            />

            <sb-radio-button-group
              *ngSwitchCase="'toggle'"
              id="{{ field.name }}"
              name="{{ field.name }}"
              [options]="field.options"
              [formControl]="control"
            ></sb-radio-button-group>

            <select
              *ngSwitchCase="'select'"
              class="form-control input-sm"
              id="{{ field.name }}"
              name="{{ field.name }}"
              [formControl]="control"
            >
              <option
                *ngFor="let option of field.options"
                [ngValue]="option.value"
              >
                {{ option.text }}
              </option>
            </select>
          </ng-container>

          <ng-container
            *ngIf="control.invalid && (control.dirty || control.touched)"
          >
            <p aria-live="polite" class="help-block small red">
              <ng-container *ngIf="control.errors.required">
                {{ 'common.form-field-message.required' | translate }}
              </ng-container>
              <ng-container *ngIf="control.errors.fileName">
                {{ control.errors.fileName.messageId | translate }}
              </ng-container>
            </p>
          </ng-container>
        </ng-template>
      </div>
    </ng-container>
  </div>
  <div class="controls">
    <ng-container *ngIf="_form.userQueryId == null; else userQuery">
      <div class="form-group inline-checkbox-form-group">
        <input
          id="save-query-checkbox"
          type="checkbox"
          [ngClass]="{
            'text-muted': saveQueryCheckboxDisabled
          }"
          [disabled]="saveQueryCheckboxDisabled"
          [(ngModel)]="saveQueryOnSubmit"
          [ngModelOptions]="{ standalone: true }"
        />
        <label for="save-query-checkbox">
          {{ 'user-query.action.save.label' | translate }}
        </label>
      </div>
    </ng-container>
    <ng-template #userQuery>
      <button
        type="button"
        class="btn btn-info aqua"
        [disabled]="saveQueryButtonDisabled"
        (click)="onSaveQueryButtonClick()"
      >
        {{ 'user-query.action.save.label' | translate }}
      </button>
    </ng-template>
    <button
      type="submit"
      class="btn btn-primary"
      [disabled]="createReportButtonDisabled"
    >
      {{ 'report-download.form.submit' | translate }}
    </button>
    <button
      type="button"
      class="btn btn-default"
      (click)="onCancelButtonClick()"
    >
      {{ 'report-download.form.cancel' | translate }}
    </button>
  </div>
</form>
