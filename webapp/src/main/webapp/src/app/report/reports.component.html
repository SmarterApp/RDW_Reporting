<h3 class="blue mb-md">{{'labels.reports.heading' | translate}}</h3>

<div class="well" *ngIf="resolution.isOk()">

  <p *ngIf="!reports.length" [innerHtml]="'labels.reports.no-reports-html' | translate"></p>

  <p-dataTable *ngIf="reports.length"
      [value]="reports"
      sortField="created"
      sortOrder="-1"
      tableStyleClass="table table-striped table-hover">

    <p-column field="label" header="{{'labels.reports.column.label.header' | translate}}" sortable="true">
      <ng-template let-report="rowData" pTemplate="body">
        <div *ngIf="report.processing" [title]="report.label"  class="label-max-width">{{report.label}}</div>
        <button *ngIf="report.completed" [title]="report.label" class="btn btn-info btn-xs label-max-width" (click)="download(report)"><i class="fa fa-cloud-download mr-xs" aria-hidden="true"></i> {{report.label}}</button>
        <button *ngIf="report.regenerable" [title]="report.label" class="btn btn-default btn-xs label-max-width" (click)="regenerate(report)"><i class="fa fa-refresh mr-xs" aria-hidden="true"></i> {{report.label}}</button>
      </ng-template>
    </p-column>
    <p-column field="reportType" header="{{'labels.reports.column.report-type.header' | translate}}" sortable="true">
      <ng-template let-report="rowData" pTemplate="body">
        {{ 'labels.reports.reportType.' + report.reportType | translate }}
      </ng-template>
    </p-column>
    <p-column field="assessmentType" header="{{'labels.reports.column.assessment-type.header' | translate}}" sortable="true">
      <ng-template let-report="rowData" pTemplate="body">
        <span *ngIf="!report.assessmentType">{{'labels.reports.all' | translate}}</span>
        <span *ngIf="report.assessmentType">{{report.assessmentType | assessmentType}}</span>
      </ng-template>
    </p-column>
    <p-column field="subjectId" header="{{'labels.reports.column.subject.header' | translate}}" sortable="true">
      <ng-template let-report="rowData" pTemplate="body">
        {{ 'labels.reports.subjects.' + report.subjectId | translate }}
      </ng-template>
    </p-column>
    <p-column field="schoolYear" header="{{'labels.reports.column.school-year.header' | translate}}" sortable="true">
      <ng-template let-report="rowData" pTemplate="body">
        {{ report.schoolYear | schoolYear }}
      </ng-template>
    </p-column>
    <p-column field="status" sortable="true" header="{{'labels.reports.column.status.header' | translate}}">
      <ng-template let-report="rowData" pTemplate="body">
        <span class="label border-only {{report.statusColor}}">{{ 'labels.reports.status.' + report.status | translate }}</span>
      </ng-template>
    </p-column>
    <p-column field="created" header="{{'labels.reports.column.created.header' | translate}}" sortable="true">
      <ng-template let-report="rowData" pTemplate="body">{{ report.created | date:'medium' }}</ng-template>
    </p-column>
  </p-dataTable>

</div>

<div class="well" *ngIf="resolution.isError()">
  <p>{{'labels.reports.messages.get-reports-error' | translate}}</p>
  <button class="btn btn-primary" (click)="reload()"><i class="fa fa-refresh"></i> {{'labels.reports.reload' | translate}}</button>
</div>


