package org.opentestsystem.rdw.olap.sqlbuilder.impl.template;

import org.opentestsystem.rdw.olap.model.ReportTemplate;
import org.opentestsystem.rdw.olap.model.ReportTemplate.Builder;
import org.opentestsystem.rdw.olap.model.TargetOrganizationQuery;
import org.opentestsystem.rdw.olap.sqlbuilder.impl.QueryProviderRepositoryHelper;
import org.opentestsystem.rdw.reporting.common.model.Organization;


/**
 * This implementation is responsible for converting an instance of an {@link TargetOrganizationQuery} into a {@link ReportTemplate}
 */
@SuppressWarnings("unchecked")
public class TargetReportTemplateProvider extends SimpleReportTemplateProvider<Builder, ReportTemplate, TargetOrganizationQuery> {

    public TargetReportTemplateProvider(final Organization state,
                                        final QueryProviderRepositoryHelper repositoryHelper) {
        super(state, repositoryHelper);
    }

    @Override
    public Builder createBuilderWithCommonAttributes(final TargetOrganizationQuery query) {
        return super.createBuilderWithCommonAttributes(query)
                .targetsByAssessmentId(getRepositoryHelper().findTargets(query));
    }
}