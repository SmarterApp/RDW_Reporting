package org.opentestsystem.rdw.olap.service.impl;

import org.opentestsystem.rdw.olap.model.ReportOptions;
import org.opentestsystem.rdw.olap.service.AdministrationConditionService;
import org.opentestsystem.rdw.olap.service.AssessmentGradeService;
import org.opentestsystem.rdw.olap.service.AssessmentTypeService;
import org.opentestsystem.rdw.olap.service.CompletenessService;
import org.opentestsystem.rdw.olap.service.EthnicityService;
import org.opentestsystem.rdw.olap.service.GenderService;
import org.opentestsystem.rdw.olap.service.ReportOptionService;
import org.opentestsystem.rdw.olap.service.SchoolYearService;
import org.opentestsystem.rdw.olap.service.SubjectService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Service;

/**
 * This implementation caches the generated report options
 */
@Service
class CachingReportOptionService implements ReportOptionService {

    @Autowired
    private AdministrationConditionService administrationConditionService;

    @Autowired
    private AssessmentTypeService assessmentTypeService;

    @Autowired
    private AssessmentGradeService assessmentGradeService;

    @Autowired
    private CompletenessService completenessService;

    @Autowired
    private EthnicityService ethnicityService;

    @Autowired
    private GenderService genderService;

    @Autowired
    private SchoolYearService schoolYearService;

    @Autowired
    private SubjectService subjectService;

    @Override
    @Cacheable("reportOptions")
    public ReportOptions getReportOptions() {
        return ReportOptions.builder()
                .administrationConditions(administrationConditionService.getAdministrationConditions())
                .assessmentTypes(assessmentTypeService.getAssessmentTypes())
                .grades(assessmentGradeService.getAssessmentGrades())
                .completenesses(completenessService.getCompletenesses())
                .ethnicities(ethnicityService.getEthnicities())
                .genders(genderService.getGenders())
                .schoolYears(schoolYearService.getSchoolYears())
                .subjects(subjectService.getSubjects())
                .build();
    }

}
