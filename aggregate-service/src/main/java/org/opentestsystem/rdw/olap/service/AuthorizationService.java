package org.opentestsystem.rdw.olap.service;

import org.opentestsystem.rdw.reporting.common.model.AbstractAggregateReportQuery;
import org.opentestsystem.rdw.reporting.common.security.User;

import javax.validation.constraints.NotNull;

/**
 * Service responsible for holding aggregate report security logic
 */
public interface AuthorizationService {

    /**
     * Ensures that the given user has the authority to create the given report based on the query content
     *
     * @param user  the {@link User} creating the report
     * @param query the query that the user would like the create the report with
     * @throws RuntimeException when the user is not authorized to create the report
     */
    void checkAuthorization(@NotNull User user, @NotNull AbstractAggregateReportQuery query);

}
