package org.opentestsystem.rdw.olap.service;

import org.opentestsystem.rdw.reporting.common.model.ReportQuery;
import org.opentestsystem.rdw.reporting.common.web.security.User;

import javax.validation.constraints.NotNull;

/**
 * Service responsible for holding aggregate report security logic
 */
public interface AuthorizationService {

    /**
     * Ensures that the given user has the authority to create the given report based on the query content
     *
     * @param user  the {@link User} creating the report
     * @param query the {@link ReportQuery} that the user would like the create the report with
     * @throws RuntimeException when the user is not authorized to create the report
     */
    void checkAuthorization(@NotNull User user, @NotNull ReportQuery query);

    /**
     * Returns if the result may contain embargo enabled data
     *
     * @param user  the {@link User} creating the report
     * @param query the {@link ReportQuery} that the user would like the create the report with
     * @return true if the result may contain embargo enabled data
     */
    boolean isMayContainEmbargoedResults(User user, ReportQuery query);

}
