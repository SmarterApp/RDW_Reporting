package org.opentestsystem.rdw.olap.model;

import com.google.common.collect.ImmutableList;
import org.opentestsystem.rdw.reporting.common.model.DimensionType;
import org.opentestsystem.rdw.reporting.common.model.Organization;
import org.opentestsystem.rdw.reporting.common.model.StudentFilter;

import java.util.List;

/**
 * Relays the options that may be included in an aggregate report request
 */
public class ReportOptions {

    private List<String> assessmentGrades;
    private List<String> assessmentTypes;
    private List<String> completenesses;
    private Organization defaultOrganization;
    private List<DimensionType> dimensionTypes;
    private List<Integer> schoolYears;
    private List<SubjectAssessment> subjects;
    private List<String> interimAdministrationConditions;
    private List<String> summativeAdministrationConditions;
    private List<Claim> claims;
    private List<AltScore> altScores;
    private boolean statewideReporter;
    private List<StudentFilter> studentFilters;

    public static Builder builder() {
        return new Builder();
    }

    public List<String> getAssessmentGrades() {
        return assessmentGrades;
    }

    public List<String> getAssessmentTypes() {
        return assessmentTypes;
    }

    public List<String> getCompletenesses() {
        return completenesses;
    }

    public Organization getDefaultOrganization() {
        return defaultOrganization;
    }

    public List<DimensionType> getDimensionTypes() {
        return dimensionTypes;
    }

    public List<Integer> getSchoolYears() {
        return schoolYears;
    }

    public List<SubjectAssessment> getSubjects() {
        return subjects;
    }

    public List<String> getInterimAdministrationConditions() {
        return interimAdministrationConditions;
    }

    public List<String> getSummativeAdministrationConditions() {
        return summativeAdministrationConditions;
    }

    public List<Claim> getClaims() {
        return claims;
    }

    public List<AltScore> getAltScores() {
        return altScores;
    }

    public boolean isStatewideReporter() {
        return statewideReporter;
    }

    public List<StudentFilter> getStudentFilters() {
        return studentFilters;
    }

    public static class Builder {

        private List<String> assessmentGrades;
        private List<String> assessmentTypes;
        private List<String> completenesses;
        private List<DimensionType> dimensionTypes;
        private List<Integer> schoolYears;
        private List<SubjectAssessment> subjects;
        private List<String> interimAdministrationConditions;
        private List<String> summativeAdministrationConditions;
        private List<Claim> claims;
        private List<AltScore> altScores;
        private boolean statewideReporter;
        private Organization defaultOrganization;
        private List<StudentFilter> studentFilters;

        public Builder assessmentGrades(final List<String> assessmentGrades) {
            this.assessmentGrades = assessmentGrades;
            return this;
        }

        public Builder assessmentTypes(final List<String> assessmentTypes) {
            this.assessmentTypes = assessmentTypes;
            return this;
        }

        public Builder completenesses(final List<String> completenesses) {
            this.completenesses = completenesses;
            return this;
        }

        public Builder defaultOrganization(final Organization defaultOrganization) {
            this.defaultOrganization = defaultOrganization;
            return this;
        }

        public Builder dimensionTypes(final List<DimensionType> dimensionTypes) {
            this.dimensionTypes = dimensionTypes;
            return this;
        }

        public Builder schoolYears(final List<Integer> schoolYears) {
            this.schoolYears = schoolYears;
            return this;
        }

        public Builder subjects(final List<SubjectAssessment> subjects) {
            this.subjects = subjects;
            return this;
        }

        public Builder interimAdministrationConditions(final List<String> interimAdministrationConditions) {
            this.interimAdministrationConditions = interimAdministrationConditions;
            return this;
        }

        public Builder summativeAdministrationConditions(final List<String> summativeAdministrationConditions) {
            this.summativeAdministrationConditions = summativeAdministrationConditions;
            return this;
        }

        public Builder claims(final List<Claim> claims) {
            this.claims = claims;
            return this;
        }

        public Builder altScores(final List<AltScore> altScores) {
            this.altScores = altScores;
            return this;
        }

        public Builder statewideReporter(final boolean statewideReporter) {
            this.statewideReporter = statewideReporter;
            return this;
        }

        public Builder studentFilters(final List<StudentFilter> studentFilters) {
            this.studentFilters = studentFilters;
            return this;
        }

        public Builder copy(final ReportOptions options) {
            this.assessmentGrades = options.assessmentGrades;
            this.assessmentTypes = options.assessmentTypes;
            this.completenesses = options.completenesses;
            this.defaultOrganization = options.defaultOrganization;
            this.dimensionTypes = options.dimensionTypes;
            this.schoolYears = options.schoolYears;
            this.subjects = options.subjects;
            this.interimAdministrationConditions = options.interimAdministrationConditions;
            this.summativeAdministrationConditions = options.summativeAdministrationConditions;
            this.statewideReporter = options.statewideReporter;
            this.claims = options.claims;
            this.altScores = options.altScores;
            this.studentFilters = options.studentFilters;
            return this;
        }

        public ReportOptions build() {
            final ReportOptions options = new ReportOptions();
            options.assessmentGrades = createImmutableList(assessmentGrades);
            options.assessmentTypes = createImmutableList(assessmentTypes);
            options.completenesses = createImmutableList(completenesses);
            options.defaultOrganization = defaultOrganization;
            options.dimensionTypes = createImmutableList(dimensionTypes);
            options.schoolYears = createImmutableList(schoolYears);
            options.subjects = createImmutableList(subjects);
            options.interimAdministrationConditions = createImmutableList(interimAdministrationConditions);
            options.summativeAdministrationConditions = createImmutableList(summativeAdministrationConditions);
            options.statewideReporter = statewideReporter;
            options.claims = createImmutableList(claims);
            options.altScores = createImmutableList(altScores);
            options.studentFilters = createImmutableList(studentFilters);
            return options;
        }

        /**
         * Creates an immutable list from the given values.
         * If the value is null it returns an empty immutable list.
         *
         * @param values the values to create the list from
         * @param <T>    the type of values in the list
         * @return an immutable list copy of the values or an empty list if the values are null
         */
        private <T> ImmutableList<T> createImmutableList(final Iterable<T> values) {
            return values != null ? ImmutableList.copyOf(values) : ImmutableList.of();
        }
    }
}
