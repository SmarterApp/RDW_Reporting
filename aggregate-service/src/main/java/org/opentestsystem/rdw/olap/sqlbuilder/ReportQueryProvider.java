package org.opentestsystem.rdw.olap.sqlbuilder;

import org.opentestsystem.rdw.reporting.common.model.DimensionType;
import org.opentestsystem.rdw.reporting.common.model.ReportQuery;

/**
 * Implementation of this interface is responsible for converting a {@link ReportQuery} to one or multiple {@link QueryWithReportTemplate}
 */
public interface ReportQueryProvider {
    /**
     * Converts a given {@link ReportQuery} to one or multiple {@link QueryWithReportTemplate}
     * <p>
     * {@link ReportQuery} may include different types of organizations and dimensions.
     * Each pair of organization/dimension is a separate {@link QueryWithReportTemplate}
     *
     * @param query {@link ReportQuery}
     * @return a collection of {@link QueryWithReportTemplate}s
     */
    Iterable<QueryWithReportTemplate> toQuery(ReportQuery query);

    /**
     * Returns an estimated row count for the given {@link ReportQuery}
     * Note: since we do not back-fill the rows for the {@link DimensionType#StudentEnrolledGrade}, it counts it as one grade
     *
     * @param query {@link ReportQuery}
     * @return estimated row count
     */
    int toEstimatedCount(ReportQuery query);
}