package org.opentestsystem.rdw.olap;

import org.opentestsystem.rdw.reporting.common.model.AggregateRow;

import java.util.List;

import static org.assertj.core.api.Assertions.assertThat;
import static org.opentestsystem.rdw.reporting.common.model.OrganizationType.District;
import static org.opentestsystem.rdw.reporting.common.model.OrganizationType.State;

final public class TestUtils {
    private TestUtils() {
    }

    public static void verifyStateStudentCount(final List<AggregateRow> rows, final int expectedCount) {
        assertThat(rows.stream()
                .filter(r -> (r.getOrganization().getOrganizationType() == State))
                .mapToInt(r -> r.getMeasures().getStudentCount())
                .sum())
                .isEqualTo(expectedCount);
    }

    public static void verifyDistrictStudentCount(final List<AggregateRow> rows, final long districtId, final int expectedCount) {
        assertThat(rows.stream()
                .filter(r -> (r.getOrganization().getOrganizationType() == District && r.getOrganization().getId() == districtId))
                .mapToInt(r -> r.getMeasures().getStudentCount())
                .sum())
                .isEqualTo(expectedCount);
    }
}