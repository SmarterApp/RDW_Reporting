package org.opentestsystem.rdw.admin.model;

/**
 * This model represents a CSV Validation result containing the ending row
 * and success or failure message
 */
public class CsvValidationResult {

    private long row;
    private String message;
    private boolean ok;

    /**
     * @return The failed record's row
     */
    public long getRow() {
        return row;
    }

    /**
     * @return The failure message
     */
    public String getMessage() {
        return message;
    }

    /**
     * @return true if the validation passed for this row
     */
    public boolean isOk() {
        return ok;
    }

    public static Builder builder() {
        return new Builder();
    }

    /**
     * Creates a successful {@link CsvValidationResult} for the given row and message
     *
     * @param row the row number that was validated
     * @param message the success message
     * @return a {@link CsvValidationResult} for the given row and message and sets {@link CsvValidationResult#isOk()} to <code>true</code>
     */
    public static CsvValidationResult success(final long row, final String message) {
        return CsvValidationResult.builder()
                .row(row)
                .message(message)
                .ok(true)
                .build();
    }

    /**
     * Creates a failure {@link CsvValidationResult} for the given row and message
     *
     * @param row the row number that was validated
     * @param message the success message
     * @return a {@link CsvValidationResult} for the given row and message and sets {@link CsvValidationResult#isOk()} to <code>false</code>
     */
    public static CsvValidationResult failure(final long row, final String message) {
        return CsvValidationResult.builder()
                .row(row)
                .message(message)
                .ok(false)
                .build();
    }

    public static class Builder {

        private long row;
        private String message;
        private boolean ok;

        public CsvValidationResult build() {
            final CsvValidationResult result = new CsvValidationResult();
            result.row = row;
            result.message = message;
            result.ok = ok;
            return result;
        }

        public Builder row(final long row) {
            this.row = row;
            return this;
        }

        public Builder message(final String message) {
            this.message = message;
            return this;
        }

        public Builder ok(final boolean ok) {
            this.ok = ok;
            return this;
        }
    }
}
