package org.opentestsystem.rdw.admin.service.impl;

import com.google.common.collect.ImmutableMap;
import org.opentestsystem.rdw.admin.service.Comparer;
import org.opentestsystem.rdw.admin.service.PipelineOutputComparisonService;
import org.springframework.stereotype.Service;

import java.util.Map;
import java.util.Objects;

@Service
class DefaultPipelineOutputComparisonService implements PipelineOutputComparisonService {

    private static final Map<String, Comparer<String>> comparersByInputType = ImmutableMap.<String, Comparer<String>>builder()
            .put("xml", new XmlComparer())
            .put("csv", new CsvComparer())
            .build();

    @Override
    public boolean equals(final String a, final String b, final String inputType) {
        final Comparer<String> comparer = comparersByInputType.get(inputType);
        return comparer != null
                ? comparer.equals(a, b)
                : Objects.equals(a, b);
    }

}
