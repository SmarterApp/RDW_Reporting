package org.opentestsystem.rdw.admin.service.impl;


import org.opentestsystem.rdw.admin.service.TenantServiceDefaultProperties;
import org.opentestsystem.rdw.archive.ArchivePropertiesTenant;
import org.opentestsystem.rdw.multitenant.datasource.DataSourceElementsTenant;
import org.opentestsystem.rdw.reporting.common.configuration.ReportingSystemSettings;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;


@Service
public class DefaultTenantPropertiesService implements TenantServiceDefaultProperties {
    private static final Logger logger = LoggerFactory.getLogger(DefaultTenantPropertiesService.class);



    DefaultTenantPropertiesService() {}

    @Override
    public ReportingSystemSettings getReportingSystemSettings() {
        String uri = "http://localhost:4200/api/settings";
        //todo auth?
        RestTemplate restTemplate = new RestTemplate();
        ReportingSystemSettings reportingSystemProperties =
                restTemplate.getForObject(uri, ReportingSystemSettings.class);
        logger.info("testing response to get for ReportingSystemProperties = {}", reportingSystemProperties);
        return reportingSystemProperties;
    }

    @Override
    public DataSourceElementsTenant getDataSourceElementsTenant() {
        String uri = "http://localhost:4200/api/settings";
        //todo auth?
        RestTemplate restTemplate = new RestTemplate();
        DataSourceElementsTenant dataSourceElementsTenant =
                restTemplate.getForObject(uri, DataSourceElementsTenant.class);
        logger.info("testing response to get for ReportingSystemProperties = {}", dataSourceElementsTenant);

        return dataSourceElementsTenant;
    }

    @Override
    public ArchivePropertiesTenant getArchivePropertiesTenant() {
        String uri = "http://localhost:4200/api/settings";
        //todo auth?
        RestTemplate restTemplate = new RestTemplate();
        ArchivePropertiesTenant archivePropertiesTenant =
                restTemplate.getForObject(uri, ArchivePropertiesTenant.class);
        logger.info("testing response to get for ReportingSystemProperties = {}", archivePropertiesTenant);
        return archivePropertiesTenant;
    }
}
