package org.opentestsystem.rdw.admin.service.impl;

import org.apache.commons.lang.StringUtils;
import org.springframework.stereotype.Service;

import java.util.Optional;
import org.opentestsystem.rdw.admin.client.DefaultConfigServerClient;
import org.opentestsystem.rdw.admin.service.TenantConfigService;

@Service
public class DefaultTenantConfigService implements TenantConfigService {

    private DefaultConfigServerClient defaultConfigServerClient;
    private final String CIPHER = "{cipher}";

    public DefaultTenantConfigService(DefaultConfigServerClient defaultConfigServerClient) {
        this.defaultConfigServerClient = defaultConfigServerClient;
    }

    @Override
    public Optional<String> decrypt(String encrypted) {
        // handle removing "{cipher}"
        final String cleanPassword = StringUtils.removeStart(encrypted, CIPHER);
        return defaultConfigServerClient.decryptedPassword(encrypted);
    }
}
