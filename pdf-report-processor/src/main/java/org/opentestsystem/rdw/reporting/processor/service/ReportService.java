package org.opentestsystem.rdw.reporting.processor.service;

import org.opentestsystem.rdw.reporting.common.model.Report;

import java.io.InputStream;
import java.util.Collection;
import java.util.List;
import java.util.Optional;

/**
 * Implementations of this interface are responsible for creating and retrieving Reports.
 */
public interface ReportService {

    /**
     * Insert a new Report record.
     *
     * @param report A report
     * @return The inserted Report with an initialized {@link Report#getId()}
     */
    Report insert(Report report);

    /**
     * Find all Reports for a given user, optionally filtered by Report id.
     *
     * @param user      The user
     * @param reportIds Optional report id filter, empty returns all reports for the user
     * @return  The requested reports
     */
    List<Report> findAllByUserAndId(String user, Collection<Long> reportIds);

    /**
     * Retrieve the report content bytes for the given report.
     * Note: Callers MUST close the InputStream when finished.
     *
     * @param reportId  A report id
     * @return A stream providing the report bytes
     */
    InputStream getContent(long reportId);

    /**
     * Retrieve a report by id.
     *
     * @param reportId  The report id
     * @return The report, if it exists
     */
    Optional<Report> findOneById(long reportId);

    /**
     * Save an updated Report.
     *
     * @param report A report
     * @return The saved report
     */
    Report update(final Report report);
}
