package org.opentestsystem.rdw.reporting.common.stream;

import org.opentestsystem.rdw.reporting.common.web.security.User;
import org.springframework.messaging.Message;

/**
 * Implementations of this interface are responsible for appending and retrieving
 * authentication information to and from messages.
 */
public interface MessageSecurityService {

    /**
     * Append the user authentication to the given message.
     *
     * @param message   A message
     * @param user      An authenticated user
     * @param <T>       The message payload class
     * @return  The message with user authentication
     */
    <T> Message<T> withUser(Message<T> message, User user);

    /**
     * Retrieve the user authentication from the given message.
     *
     * @param message   A message
     * @return  The message's user authentication
     */
    User getUser(Message<?> message);
}
